{"version":3,"file":"index.js","mappings":"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","sources":["webpack://ipycanvas/./node_modules/base64-js/index.js","webpack://ipycanvas/./node_modules/buffer/index.js","webpack://ipycanvas/./node_modules/ieee754/index.js","webpack://ipycanvas/./node_modules/isarray/index.js","webpack://ipycanvas/external amd \"@jupyter-widgets/base\"","webpack://ipycanvas/webpack/bootstrap","webpack://ipycanvas/webpack/runtime/define property getters","webpack://ipycanvas/webpack/runtime/global","webpack://ipycanvas/webpack/runtime/hasOwnProperty shorthand","webpack://ipycanvas/webpack/runtime/make namespace object","webpack://ipycanvas/./src/version.ts","webpack://ipycanvas/./node_modules/roughjs/bin/geometry.js","webpack://ipycanvas/./node_modules/roughjs/bin/fillers/scan-line-hachure.js","webpack://ipycanvas/./node_modules/roughjs/bin/fillers/hachure-filler.js","webpack://ipycanvas/./node_modules/roughjs/bin/fillers/zigzag-filler.js","webpack://ipycanvas/./node_modules/roughjs/bin/fillers/hatch-filler.js","webpack://ipycanvas/./node_modules/roughjs/bin/fillers/dot-filler.js","webpack://ipycanvas/./node_modules/roughjs/bin/fillers/dashed-filler.js","webpack://ipycanvas/./node_modules/roughjs/bin/fillers/zigzag-line-filler.js","webpack://ipycanvas/./node_modules/roughjs/bin/fillers/filler.js","webpack://ipycanvas/./node_modules/roughjs/bin/math.js","webpack://ipycanvas/./node_modules/path-data-parser/lib/parser.js","webpack://ipycanvas/./node_modules/path-data-parser/lib/absolutize.js","webpack://ipycanvas/./node_modules/path-data-parser/lib/normalize.js","webpack://ipycanvas/./node_modules/roughjs/bin/renderer.js","webpack://ipycanvas/./node_modules/points-on-curve/lib/curve-to-bezier.js","webpack://ipycanvas/./node_modules/points-on-curve/lib/index.js","webpack://ipycanvas/./node_modules/roughjs/bin/generator.js","webpack://ipycanvas/./node_modules/points-on-path/lib/index.js","webpack://ipycanvas/./node_modules/roughjs/bin/canvas.js","webpack://ipycanvas/./src/utils.ts","webpack://ipycanvas/./src/widget.ts","webpack://ipycanvas/./src/extension.ts"],"sourcesContent":["'use strict'\n\nexports.byteLength = byteLength\nexports.toByteArray = toByteArray\nexports.fromByteArray = fromByteArray\n\nvar lookup = []\nvar revLookup = []\nvar Arr = typeof Uint8Array !== 'undefined' ? Uint8Array : Array\n\nvar code = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'\nfor (var i = 0, len = code.length; i < len; ++i) {\n  lookup[i] = code[i]\n  revLookup[code.charCodeAt(i)] = i\n}\n\n// Support decoding URL-safe base64 strings, as Node.js does.\n// See: https://en.wikipedia.org/wiki/Base64#URL_applications\nrevLookup['-'.charCodeAt(0)] = 62\nrevLookup['_'.charCodeAt(0)] = 63\n\nfunction getLens (b64) {\n  var len = b64.length\n\n  if (len % 4 > 0) {\n    throw new Error('Invalid string. Length must be a multiple of 4')\n  }\n\n  // Trim off extra bytes after placeholder bytes are found\n  // See: https://github.com/beatgammit/base64-js/issues/42\n  var validLen = b64.indexOf('=')\n  if (validLen === -1) validLen = len\n\n  var placeHoldersLen = validLen === len\n    ? 0\n    : 4 - (validLen % 4)\n\n  return [validLen, placeHoldersLen]\n}\n\n// base64 is 4/3 + up to two characters of the original data\nfunction byteLength (b64) {\n  var lens = getLens(b64)\n  var validLen = lens[0]\n  var placeHoldersLen = lens[1]\n  return ((validLen + placeHoldersLen) * 3 / 4) - placeHoldersLen\n}\n\nfunction _byteLength (b64, validLen, placeHoldersLen) {\n  return ((validLen + placeHoldersLen) * 3 / 4) - placeHoldersLen\n}\n\nfunction toByteArray (b64) {\n  var tmp\n  var lens = getLens(b64)\n  var validLen = lens[0]\n  var placeHoldersLen = lens[1]\n\n  var arr = new Arr(_byteLength(b64, validLen, placeHoldersLen))\n\n  var curByte = 0\n\n  // if there are placeholders, only get up to the last complete 4 chars\n  var len = placeHoldersLen > 0\n    ? validLen - 4\n    : validLen\n\n  var i\n  for (i = 0; i < len; i += 4) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 18) |\n      (revLookup[b64.charCodeAt(i + 1)] << 12) |\n      (revLookup[b64.charCodeAt(i + 2)] << 6) |\n      revLookup[b64.charCodeAt(i + 3)]\n    arr[curByte++] = (tmp >> 16) & 0xFF\n    arr[curByte++] = (tmp >> 8) & 0xFF\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  if (placeHoldersLen === 2) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 2) |\n      (revLookup[b64.charCodeAt(i + 1)] >> 4)\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  if (placeHoldersLen === 1) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 10) |\n      (revLookup[b64.charCodeAt(i + 1)] << 4) |\n      (revLookup[b64.charCodeAt(i + 2)] >> 2)\n    arr[curByte++] = (tmp >> 8) & 0xFF\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  return arr\n}\n\nfunction tripletToBase64 (num) {\n  return lookup[num >> 18 & 0x3F] +\n    lookup[num >> 12 & 0x3F] +\n    lookup[num >> 6 & 0x3F] +\n    lookup[num & 0x3F]\n}\n\nfunction encodeChunk (uint8, start, end) {\n  var tmp\n  var output = []\n  for (var i = start; i < end; i += 3) {\n    tmp =\n      ((uint8[i] << 16) & 0xFF0000) +\n      ((uint8[i + 1] << 8) & 0xFF00) +\n      (uint8[i + 2] & 0xFF)\n    output.push(tripletToBase64(tmp))\n  }\n  return output.join('')\n}\n\nfunction fromByteArray (uint8) {\n  var tmp\n  var len = uint8.length\n  var extraBytes = len % 3 // if we have 1 byte left, pad 2 bytes\n  var parts = []\n  var maxChunkLength = 16383 // must be multiple of 3\n\n  // go through the array every three bytes, we'll deal with trailing stuff later\n  for (var i = 0, len2 = len - extraBytes; i < len2; i += maxChunkLength) {\n    parts.push(encodeChunk(uint8, i, (i + maxChunkLength) > len2 ? len2 : (i + maxChunkLength)))\n  }\n\n  // pad the end with zeros, but make sure to not forget the extra bytes\n  if (extraBytes === 1) {\n    tmp = uint8[len - 1]\n    parts.push(\n      lookup[tmp >> 2] +\n      lookup[(tmp << 4) & 0x3F] +\n      '=='\n    )\n  } else if (extraBytes === 2) {\n    tmp = (uint8[len - 2] << 8) + uint8[len - 1]\n    parts.push(\n      lookup[tmp >> 10] +\n      lookup[(tmp >> 4) & 0x3F] +\n      lookup[(tmp << 2) & 0x3F] +\n      '='\n    )\n  }\n\n  return parts.join('')\n}\n","/*!\n * The buffer module from node.js, for the browser.\n *\n * @author   Feross Aboukhadijeh <http://feross.org>\n * @license  MIT\n */\n/* eslint-disable no-proto */\n\n'use strict'\n\nvar base64 = require('base64-js')\nvar ieee754 = require('ieee754')\nvar isArray = require('isarray')\n\nexports.Buffer = Buffer\nexports.SlowBuffer = SlowBuffer\nexports.INSPECT_MAX_BYTES = 50\n\n/**\n * If `Buffer.TYPED_ARRAY_SUPPORT`:\n *   === true    Use Uint8Array implementation (fastest)\n *   === false   Use Object implementation (most compatible, even IE6)\n *\n * Browsers that support typed arrays are IE 10+, Firefox 4+, Chrome 7+, Safari 5.1+,\n * Opera 11.6+, iOS 4.2+.\n *\n * Due to various browser bugs, sometimes the Object implementation will be used even\n * when the browser supports typed arrays.\n *\n * Note:\n *\n *   - Firefox 4-29 lacks support for adding new properties to `Uint8Array` instances,\n *     See: https://bugzilla.mozilla.org/show_bug.cgi?id=695438.\n *\n *   - Chrome 9-10 is missing the `TypedArray.prototype.subarray` function.\n *\n *   - IE10 has a broken `TypedArray.prototype.subarray` function which returns arrays of\n *     incorrect length in some situations.\n\n * We detect these buggy browsers and set `Buffer.TYPED_ARRAY_SUPPORT` to `false` so they\n * get the Object implementation, which is slower but behaves correctly.\n */\nBuffer.TYPED_ARRAY_SUPPORT = global.TYPED_ARRAY_SUPPORT !== undefined\n  ? global.TYPED_ARRAY_SUPPORT\n  : typedArraySupport()\n\n/*\n * Export kMaxLength after typed array support is determined.\n */\nexports.kMaxLength = kMaxLength()\n\nfunction typedArraySupport () {\n  try {\n    var arr = new Uint8Array(1)\n    arr.__proto__ = {__proto__: Uint8Array.prototype, foo: function () { return 42 }}\n    return arr.foo() === 42 && // typed array instances can be augmented\n        typeof arr.subarray === 'function' && // chrome 9-10 lack `subarray`\n        arr.subarray(1, 1).byteLength === 0 // ie10 has broken `subarray`\n  } catch (e) {\n    return false\n  }\n}\n\nfunction kMaxLength () {\n  return Buffer.TYPED_ARRAY_SUPPORT\n    ? 0x7fffffff\n    : 0x3fffffff\n}\n\nfunction createBuffer (that, length) {\n  if (kMaxLength() < length) {\n    throw new RangeError('Invalid typed array length')\n  }\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    // Return an augmented `Uint8Array` instance, for best performance\n    that = new Uint8Array(length)\n    that.__proto__ = Buffer.prototype\n  } else {\n    // Fallback: Return an object instance of the Buffer class\n    if (that === null) {\n      that = new Buffer(length)\n    }\n    that.length = length\n  }\n\n  return that\n}\n\n/**\n * The Buffer constructor returns instances of `Uint8Array` that have their\n * prototype changed to `Buffer.prototype`. Furthermore, `Buffer` is a subclass of\n * `Uint8Array`, so the returned instances will have all the node `Buffer` methods\n * and the `Uint8Array` methods. Square bracket notation works as expected -- it\n * returns a single octet.\n *\n * The `Uint8Array` prototype remains unmodified.\n */\n\nfunction Buffer (arg, encodingOrOffset, length) {\n  if (!Buffer.TYPED_ARRAY_SUPPORT && !(this instanceof Buffer)) {\n    return new Buffer(arg, encodingOrOffset, length)\n  }\n\n  // Common case.\n  if (typeof arg === 'number') {\n    if (typeof encodingOrOffset === 'string') {\n      throw new Error(\n        'If encoding is specified then the first argument must be a string'\n      )\n    }\n    return allocUnsafe(this, arg)\n  }\n  return from(this, arg, encodingOrOffset, length)\n}\n\nBuffer.poolSize = 8192 // not used by this implementation\n\n// TODO: Legacy, not needed anymore. Remove in next major version.\nBuffer._augment = function (arr) {\n  arr.__proto__ = Buffer.prototype\n  return arr\n}\n\nfunction from (that, value, encodingOrOffset, length) {\n  if (typeof value === 'number') {\n    throw new TypeError('\"value\" argument must not be a number')\n  }\n\n  if (typeof ArrayBuffer !== 'undefined' && value instanceof ArrayBuffer) {\n    return fromArrayBuffer(that, value, encodingOrOffset, length)\n  }\n\n  if (typeof value === 'string') {\n    return fromString(that, value, encodingOrOffset)\n  }\n\n  return fromObject(that, value)\n}\n\n/**\n * Functionally equivalent to Buffer(arg, encoding) but throws a TypeError\n * if value is a number.\n * Buffer.from(str[, encoding])\n * Buffer.from(array)\n * Buffer.from(buffer)\n * Buffer.from(arrayBuffer[, byteOffset[, length]])\n **/\nBuffer.from = function (value, encodingOrOffset, length) {\n  return from(null, value, encodingOrOffset, length)\n}\n\nif (Buffer.TYPED_ARRAY_SUPPORT) {\n  Buffer.prototype.__proto__ = Uint8Array.prototype\n  Buffer.__proto__ = Uint8Array\n  if (typeof Symbol !== 'undefined' && Symbol.species &&\n      Buffer[Symbol.species] === Buffer) {\n    // Fix subarray() in ES2016. See: https://github.com/feross/buffer/pull/97\n    Object.defineProperty(Buffer, Symbol.species, {\n      value: null,\n      configurable: true\n    })\n  }\n}\n\nfunction assertSize (size) {\n  if (typeof size !== 'number') {\n    throw new TypeError('\"size\" argument must be a number')\n  } else if (size < 0) {\n    throw new RangeError('\"size\" argument must not be negative')\n  }\n}\n\nfunction alloc (that, size, fill, encoding) {\n  assertSize(size)\n  if (size <= 0) {\n    return createBuffer(that, size)\n  }\n  if (fill !== undefined) {\n    // Only pay attention to encoding if it's a string. This\n    // prevents accidentally sending in a number that would\n    // be interpretted as a start offset.\n    return typeof encoding === 'string'\n      ? createBuffer(that, size).fill(fill, encoding)\n      : createBuffer(that, size).fill(fill)\n  }\n  return createBuffer(that, size)\n}\n\n/**\n * Creates a new filled Buffer instance.\n * alloc(size[, fill[, encoding]])\n **/\nBuffer.alloc = function (size, fill, encoding) {\n  return alloc(null, size, fill, encoding)\n}\n\nfunction allocUnsafe (that, size) {\n  assertSize(size)\n  that = createBuffer(that, size < 0 ? 0 : checked(size) | 0)\n  if (!Buffer.TYPED_ARRAY_SUPPORT) {\n    for (var i = 0; i < size; ++i) {\n      that[i] = 0\n    }\n  }\n  return that\n}\n\n/**\n * Equivalent to Buffer(num), by default creates a non-zero-filled Buffer instance.\n * */\nBuffer.allocUnsafe = function (size) {\n  return allocUnsafe(null, size)\n}\n/**\n * Equivalent to SlowBuffer(num), by default creates a non-zero-filled Buffer instance.\n */\nBuffer.allocUnsafeSlow = function (size) {\n  return allocUnsafe(null, size)\n}\n\nfunction fromString (that, string, encoding) {\n  if (typeof encoding !== 'string' || encoding === '') {\n    encoding = 'utf8'\n  }\n\n  if (!Buffer.isEncoding(encoding)) {\n    throw new TypeError('\"encoding\" must be a valid string encoding')\n  }\n\n  var length = byteLength(string, encoding) | 0\n  that = createBuffer(that, length)\n\n  var actual = that.write(string, encoding)\n\n  if (actual !== length) {\n    // Writing a hex string, for example, that contains invalid characters will\n    // cause everything after the first invalid character to be ignored. (e.g.\n    // 'abxxcd' will be treated as 'ab')\n    that = that.slice(0, actual)\n  }\n\n  return that\n}\n\nfunction fromArrayLike (that, array) {\n  var length = array.length < 0 ? 0 : checked(array.length) | 0\n  that = createBuffer(that, length)\n  for (var i = 0; i < length; i += 1) {\n    that[i] = array[i] & 255\n  }\n  return that\n}\n\nfunction fromArrayBuffer (that, array, byteOffset, length) {\n  array.byteLength // this throws if `array` is not a valid ArrayBuffer\n\n  if (byteOffset < 0 || array.byteLength < byteOffset) {\n    throw new RangeError('\\'offset\\' is out of bounds')\n  }\n\n  if (array.byteLength < byteOffset + (length || 0)) {\n    throw new RangeError('\\'length\\' is out of bounds')\n  }\n\n  if (byteOffset === undefined && length === undefined) {\n    array = new Uint8Array(array)\n  } else if (length === undefined) {\n    array = new Uint8Array(array, byteOffset)\n  } else {\n    array = new Uint8Array(array, byteOffset, length)\n  }\n\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    // Return an augmented `Uint8Array` instance, for best performance\n    that = array\n    that.__proto__ = Buffer.prototype\n  } else {\n    // Fallback: Return an object instance of the Buffer class\n    that = fromArrayLike(that, array)\n  }\n  return that\n}\n\nfunction fromObject (that, obj) {\n  if (Buffer.isBuffer(obj)) {\n    var len = checked(obj.length) | 0\n    that = createBuffer(that, len)\n\n    if (that.length === 0) {\n      return that\n    }\n\n    obj.copy(that, 0, 0, len)\n    return that\n  }\n\n  if (obj) {\n    if ((typeof ArrayBuffer !== 'undefined' &&\n        obj.buffer instanceof ArrayBuffer) || 'length' in obj) {\n      if (typeof obj.length !== 'number' || isnan(obj.length)) {\n        return createBuffer(that, 0)\n      }\n      return fromArrayLike(that, obj)\n    }\n\n    if (obj.type === 'Buffer' && isArray(obj.data)) {\n      return fromArrayLike(that, obj.data)\n    }\n  }\n\n  throw new TypeError('First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.')\n}\n\nfunction checked (length) {\n  // Note: cannot use `length < kMaxLength()` here because that fails when\n  // length is NaN (which is otherwise coerced to zero.)\n  if (length >= kMaxLength()) {\n    throw new RangeError('Attempt to allocate Buffer larger than maximum ' +\n                         'size: 0x' + kMaxLength().toString(16) + ' bytes')\n  }\n  return length | 0\n}\n\nfunction SlowBuffer (length) {\n  if (+length != length) { // eslint-disable-line eqeqeq\n    length = 0\n  }\n  return Buffer.alloc(+length)\n}\n\nBuffer.isBuffer = function isBuffer (b) {\n  return !!(b != null && b._isBuffer)\n}\n\nBuffer.compare = function compare (a, b) {\n  if (!Buffer.isBuffer(a) || !Buffer.isBuffer(b)) {\n    throw new TypeError('Arguments must be Buffers')\n  }\n\n  if (a === b) return 0\n\n  var x = a.length\n  var y = b.length\n\n  for (var i = 0, len = Math.min(x, y); i < len; ++i) {\n    if (a[i] !== b[i]) {\n      x = a[i]\n      y = b[i]\n      break\n    }\n  }\n\n  if (x < y) return -1\n  if (y < x) return 1\n  return 0\n}\n\nBuffer.isEncoding = function isEncoding (encoding) {\n  switch (String(encoding).toLowerCase()) {\n    case 'hex':\n    case 'utf8':\n    case 'utf-8':\n    case 'ascii':\n    case 'latin1':\n    case 'binary':\n    case 'base64':\n    case 'ucs2':\n    case 'ucs-2':\n    case 'utf16le':\n    case 'utf-16le':\n      return true\n    default:\n      return false\n  }\n}\n\nBuffer.concat = function concat (list, length) {\n  if (!isArray(list)) {\n    throw new TypeError('\"list\" argument must be an Array of Buffers')\n  }\n\n  if (list.length === 0) {\n    return Buffer.alloc(0)\n  }\n\n  var i\n  if (length === undefined) {\n    length = 0\n    for (i = 0; i < list.length; ++i) {\n      length += list[i].length\n    }\n  }\n\n  var buffer = Buffer.allocUnsafe(length)\n  var pos = 0\n  for (i = 0; i < list.length; ++i) {\n    var buf = list[i]\n    if (!Buffer.isBuffer(buf)) {\n      throw new TypeError('\"list\" argument must be an Array of Buffers')\n    }\n    buf.copy(buffer, pos)\n    pos += buf.length\n  }\n  return buffer\n}\n\nfunction byteLength (string, encoding) {\n  if (Buffer.isBuffer(string)) {\n    return string.length\n  }\n  if (typeof ArrayBuffer !== 'undefined' && typeof ArrayBuffer.isView === 'function' &&\n      (ArrayBuffer.isView(string) || string instanceof ArrayBuffer)) {\n    return string.byteLength\n  }\n  if (typeof string !== 'string') {\n    string = '' + string\n  }\n\n  var len = string.length\n  if (len === 0) return 0\n\n  // Use a for loop to avoid recursion\n  var loweredCase = false\n  for (;;) {\n    switch (encoding) {\n      case 'ascii':\n      case 'latin1':\n      case 'binary':\n        return len\n      case 'utf8':\n      case 'utf-8':\n      case undefined:\n        return utf8ToBytes(string).length\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return len * 2\n      case 'hex':\n        return len >>> 1\n      case 'base64':\n        return base64ToBytes(string).length\n      default:\n        if (loweredCase) return utf8ToBytes(string).length // assume utf8\n        encoding = ('' + encoding).toLowerCase()\n        loweredCase = true\n    }\n  }\n}\nBuffer.byteLength = byteLength\n\nfunction slowToString (encoding, start, end) {\n  var loweredCase = false\n\n  // No need to verify that \"this.length <= MAX_UINT32\" since it's a read-only\n  // property of a typed array.\n\n  // This behaves neither like String nor Uint8Array in that we set start/end\n  // to their upper/lower bounds if the value passed is out of range.\n  // undefined is handled specially as per ECMA-262 6th Edition,\n  // Section 13.3.3.7 Runtime Semantics: KeyedBindingInitialization.\n  if (start === undefined || start < 0) {\n    start = 0\n  }\n  // Return early if start > this.length. Done here to prevent potential uint32\n  // coercion fail below.\n  if (start > this.length) {\n    return ''\n  }\n\n  if (end === undefined || end > this.length) {\n    end = this.length\n  }\n\n  if (end <= 0) {\n    return ''\n  }\n\n  // Force coersion to uint32. This will also coerce falsey/NaN values to 0.\n  end >>>= 0\n  start >>>= 0\n\n  if (end <= start) {\n    return ''\n  }\n\n  if (!encoding) encoding = 'utf8'\n\n  while (true) {\n    switch (encoding) {\n      case 'hex':\n        return hexSlice(this, start, end)\n\n      case 'utf8':\n      case 'utf-8':\n        return utf8Slice(this, start, end)\n\n      case 'ascii':\n        return asciiSlice(this, start, end)\n\n      case 'latin1':\n      case 'binary':\n        return latin1Slice(this, start, end)\n\n      case 'base64':\n        return base64Slice(this, start, end)\n\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return utf16leSlice(this, start, end)\n\n      default:\n        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)\n        encoding = (encoding + '').toLowerCase()\n        loweredCase = true\n    }\n  }\n}\n\n// The property is used by `Buffer.isBuffer` and `is-buffer` (in Safari 5-7) to detect\n// Buffer instances.\nBuffer.prototype._isBuffer = true\n\nfunction swap (b, n, m) {\n  var i = b[n]\n  b[n] = b[m]\n  b[m] = i\n}\n\nBuffer.prototype.swap16 = function swap16 () {\n  var len = this.length\n  if (len % 2 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 16-bits')\n  }\n  for (var i = 0; i < len; i += 2) {\n    swap(this, i, i + 1)\n  }\n  return this\n}\n\nBuffer.prototype.swap32 = function swap32 () {\n  var len = this.length\n  if (len % 4 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 32-bits')\n  }\n  for (var i = 0; i < len; i += 4) {\n    swap(this, i, i + 3)\n    swap(this, i + 1, i + 2)\n  }\n  return this\n}\n\nBuffer.prototype.swap64 = function swap64 () {\n  var len = this.length\n  if (len % 8 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 64-bits')\n  }\n  for (var i = 0; i < len; i += 8) {\n    swap(this, i, i + 7)\n    swap(this, i + 1, i + 6)\n    swap(this, i + 2, i + 5)\n    swap(this, i + 3, i + 4)\n  }\n  return this\n}\n\nBuffer.prototype.toString = function toString () {\n  var length = this.length | 0\n  if (length === 0) return ''\n  if (arguments.length === 0) return utf8Slice(this, 0, length)\n  return slowToString.apply(this, arguments)\n}\n\nBuffer.prototype.equals = function equals (b) {\n  if (!Buffer.isBuffer(b)) throw new TypeError('Argument must be a Buffer')\n  if (this === b) return true\n  return Buffer.compare(this, b) === 0\n}\n\nBuffer.prototype.inspect = function inspect () {\n  var str = ''\n  var max = exports.INSPECT_MAX_BYTES\n  if (this.length > 0) {\n    str = this.toString('hex', 0, max).match(/.{2}/g).join(' ')\n    if (this.length > max) str += ' ... '\n  }\n  return '<Buffer ' + str + '>'\n}\n\nBuffer.prototype.compare = function compare (target, start, end, thisStart, thisEnd) {\n  if (!Buffer.isBuffer(target)) {\n    throw new TypeError('Argument must be a Buffer')\n  }\n\n  if (start === undefined) {\n    start = 0\n  }\n  if (end === undefined) {\n    end = target ? target.length : 0\n  }\n  if (thisStart === undefined) {\n    thisStart = 0\n  }\n  if (thisEnd === undefined) {\n    thisEnd = this.length\n  }\n\n  if (start < 0 || end > target.length || thisStart < 0 || thisEnd > this.length) {\n    throw new RangeError('out of range index')\n  }\n\n  if (thisStart >= thisEnd && start >= end) {\n    return 0\n  }\n  if (thisStart >= thisEnd) {\n    return -1\n  }\n  if (start >= end) {\n    return 1\n  }\n\n  start >>>= 0\n  end >>>= 0\n  thisStart >>>= 0\n  thisEnd >>>= 0\n\n  if (this === target) return 0\n\n  var x = thisEnd - thisStart\n  var y = end - start\n  var len = Math.min(x, y)\n\n  var thisCopy = this.slice(thisStart, thisEnd)\n  var targetCopy = target.slice(start, end)\n\n  for (var i = 0; i < len; ++i) {\n    if (thisCopy[i] !== targetCopy[i]) {\n      x = thisCopy[i]\n      y = targetCopy[i]\n      break\n    }\n  }\n\n  if (x < y) return -1\n  if (y < x) return 1\n  return 0\n}\n\n// Finds either the first index of `val` in `buffer` at offset >= `byteOffset`,\n// OR the last index of `val` in `buffer` at offset <= `byteOffset`.\n//\n// Arguments:\n// - buffer - a Buffer to search\n// - val - a string, Buffer, or number\n// - byteOffset - an index into `buffer`; will be clamped to an int32\n// - encoding - an optional encoding, relevant is val is a string\n// - dir - true for indexOf, false for lastIndexOf\nfunction bidirectionalIndexOf (buffer, val, byteOffset, encoding, dir) {\n  // Empty buffer means no match\n  if (buffer.length === 0) return -1\n\n  // Normalize byteOffset\n  if (typeof byteOffset === 'string') {\n    encoding = byteOffset\n    byteOffset = 0\n  } else if (byteOffset > 0x7fffffff) {\n    byteOffset = 0x7fffffff\n  } else if (byteOffset < -0x80000000) {\n    byteOffset = -0x80000000\n  }\n  byteOffset = +byteOffset  // Coerce to Number.\n  if (isNaN(byteOffset)) {\n    // byteOffset: it it's undefined, null, NaN, \"foo\", etc, search whole buffer\n    byteOffset = dir ? 0 : (buffer.length - 1)\n  }\n\n  // Normalize byteOffset: negative offsets start from the end of the buffer\n  if (byteOffset < 0) byteOffset = buffer.length + byteOffset\n  if (byteOffset >= buffer.length) {\n    if (dir) return -1\n    else byteOffset = buffer.length - 1\n  } else if (byteOffset < 0) {\n    if (dir) byteOffset = 0\n    else return -1\n  }\n\n  // Normalize val\n  if (typeof val === 'string') {\n    val = Buffer.from(val, encoding)\n  }\n\n  // Finally, search either indexOf (if dir is true) or lastIndexOf\n  if (Buffer.isBuffer(val)) {\n    // Special case: looking for empty string/buffer always fails\n    if (val.length === 0) {\n      return -1\n    }\n    return arrayIndexOf(buffer, val, byteOffset, encoding, dir)\n  } else if (typeof val === 'number') {\n    val = val & 0xFF // Search for a byte value [0-255]\n    if (Buffer.TYPED_ARRAY_SUPPORT &&\n        typeof Uint8Array.prototype.indexOf === 'function') {\n      if (dir) {\n        return Uint8Array.prototype.indexOf.call(buffer, val, byteOffset)\n      } else {\n        return Uint8Array.prototype.lastIndexOf.call(buffer, val, byteOffset)\n      }\n    }\n    return arrayIndexOf(buffer, [ val ], byteOffset, encoding, dir)\n  }\n\n  throw new TypeError('val must be string, number or Buffer')\n}\n\nfunction arrayIndexOf (arr, val, byteOffset, encoding, dir) {\n  var indexSize = 1\n  var arrLength = arr.length\n  var valLength = val.length\n\n  if (encoding !== undefined) {\n    encoding = String(encoding).toLowerCase()\n    if (encoding === 'ucs2' || encoding === 'ucs-2' ||\n        encoding === 'utf16le' || encoding === 'utf-16le') {\n      if (arr.length < 2 || val.length < 2) {\n        return -1\n      }\n      indexSize = 2\n      arrLength /= 2\n      valLength /= 2\n      byteOffset /= 2\n    }\n  }\n\n  function read (buf, i) {\n    if (indexSize === 1) {\n      return buf[i]\n    } else {\n      return buf.readUInt16BE(i * indexSize)\n    }\n  }\n\n  var i\n  if (dir) {\n    var foundIndex = -1\n    for (i = byteOffset; i < arrLength; i++) {\n      if (read(arr, i) === read(val, foundIndex === -1 ? 0 : i - foundIndex)) {\n        if (foundIndex === -1) foundIndex = i\n        if (i - foundIndex + 1 === valLength) return foundIndex * indexSize\n      } else {\n        if (foundIndex !== -1) i -= i - foundIndex\n        foundIndex = -1\n      }\n    }\n  } else {\n    if (byteOffset + valLength > arrLength) byteOffset = arrLength - valLength\n    for (i = byteOffset; i >= 0; i--) {\n      var found = true\n      for (var j = 0; j < valLength; j++) {\n        if (read(arr, i + j) !== read(val, j)) {\n          found = false\n          break\n        }\n      }\n      if (found) return i\n    }\n  }\n\n  return -1\n}\n\nBuffer.prototype.includes = function includes (val, byteOffset, encoding) {\n  return this.indexOf(val, byteOffset, encoding) !== -1\n}\n\nBuffer.prototype.indexOf = function indexOf (val, byteOffset, encoding) {\n  return bidirectionalIndexOf(this, val, byteOffset, encoding, true)\n}\n\nBuffer.prototype.lastIndexOf = function lastIndexOf (val, byteOffset, encoding) {\n  return bidirectionalIndexOf(this, val, byteOffset, encoding, false)\n}\n\nfunction hexWrite (buf, string, offset, length) {\n  offset = Number(offset) || 0\n  var remaining = buf.length - offset\n  if (!length) {\n    length = remaining\n  } else {\n    length = Number(length)\n    if (length > remaining) {\n      length = remaining\n    }\n  }\n\n  // must be an even number of digits\n  var strLen = string.length\n  if (strLen % 2 !== 0) throw new TypeError('Invalid hex string')\n\n  if (length > strLen / 2) {\n    length = strLen / 2\n  }\n  for (var i = 0; i < length; ++i) {\n    var parsed = parseInt(string.substr(i * 2, 2), 16)\n    if (isNaN(parsed)) return i\n    buf[offset + i] = parsed\n  }\n  return i\n}\n\nfunction utf8Write (buf, string, offset, length) {\n  return blitBuffer(utf8ToBytes(string, buf.length - offset), buf, offset, length)\n}\n\nfunction asciiWrite (buf, string, offset, length) {\n  return blitBuffer(asciiToBytes(string), buf, offset, length)\n}\n\nfunction latin1Write (buf, string, offset, length) {\n  return asciiWrite(buf, string, offset, length)\n}\n\nfunction base64Write (buf, string, offset, length) {\n  return blitBuffer(base64ToBytes(string), buf, offset, length)\n}\n\nfunction ucs2Write (buf, string, offset, length) {\n  return blitBuffer(utf16leToBytes(string, buf.length - offset), buf, offset, length)\n}\n\nBuffer.prototype.write = function write (string, offset, length, encoding) {\n  // Buffer#write(string)\n  if (offset === undefined) {\n    encoding = 'utf8'\n    length = this.length\n    offset = 0\n  // Buffer#write(string, encoding)\n  } else if (length === undefined && typeof offset === 'string') {\n    encoding = offset\n    length = this.length\n    offset = 0\n  // Buffer#write(string, offset[, length][, encoding])\n  } else if (isFinite(offset)) {\n    offset = offset | 0\n    if (isFinite(length)) {\n      length = length | 0\n      if (encoding === undefined) encoding = 'utf8'\n    } else {\n      encoding = length\n      length = undefined\n    }\n  // legacy write(string, encoding, offset, length) - remove in v0.13\n  } else {\n    throw new Error(\n      'Buffer.write(string, encoding, offset[, length]) is no longer supported'\n    )\n  }\n\n  var remaining = this.length - offset\n  if (length === undefined || length > remaining) length = remaining\n\n  if ((string.length > 0 && (length < 0 || offset < 0)) || offset > this.length) {\n    throw new RangeError('Attempt to write outside buffer bounds')\n  }\n\n  if (!encoding) encoding = 'utf8'\n\n  var loweredCase = false\n  for (;;) {\n    switch (encoding) {\n      case 'hex':\n        return hexWrite(this, string, offset, length)\n\n      case 'utf8':\n      case 'utf-8':\n        return utf8Write(this, string, offset, length)\n\n      case 'ascii':\n        return asciiWrite(this, string, offset, length)\n\n      case 'latin1':\n      case 'binary':\n        return latin1Write(this, string, offset, length)\n\n      case 'base64':\n        // Warning: maxLength not taken into account in base64Write\n        return base64Write(this, string, offset, length)\n\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return ucs2Write(this, string, offset, length)\n\n      default:\n        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)\n        encoding = ('' + encoding).toLowerCase()\n        loweredCase = true\n    }\n  }\n}\n\nBuffer.prototype.toJSON = function toJSON () {\n  return {\n    type: 'Buffer',\n    data: Array.prototype.slice.call(this._arr || this, 0)\n  }\n}\n\nfunction base64Slice (buf, start, end) {\n  if (start === 0 && end === buf.length) {\n    return base64.fromByteArray(buf)\n  } else {\n    return base64.fromByteArray(buf.slice(start, end))\n  }\n}\n\nfunction utf8Slice (buf, start, end) {\n  end = Math.min(buf.length, end)\n  var res = []\n\n  var i = start\n  while (i < end) {\n    var firstByte = buf[i]\n    var codePoint = null\n    var bytesPerSequence = (firstByte > 0xEF) ? 4\n      : (firstByte > 0xDF) ? 3\n      : (firstByte > 0xBF) ? 2\n      : 1\n\n    if (i + bytesPerSequence <= end) {\n      var secondByte, thirdByte, fourthByte, tempCodePoint\n\n      switch (bytesPerSequence) {\n        case 1:\n          if (firstByte < 0x80) {\n            codePoint = firstByte\n          }\n          break\n        case 2:\n          secondByte = buf[i + 1]\n          if ((secondByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0x1F) << 0x6 | (secondByte & 0x3F)\n            if (tempCodePoint > 0x7F) {\n              codePoint = tempCodePoint\n            }\n          }\n          break\n        case 3:\n          secondByte = buf[i + 1]\n          thirdByte = buf[i + 2]\n          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0xF) << 0xC | (secondByte & 0x3F) << 0x6 | (thirdByte & 0x3F)\n            if (tempCodePoint > 0x7FF && (tempCodePoint < 0xD800 || tempCodePoint > 0xDFFF)) {\n              codePoint = tempCodePoint\n            }\n          }\n          break\n        case 4:\n          secondByte = buf[i + 1]\n          thirdByte = buf[i + 2]\n          fourthByte = buf[i + 3]\n          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80 && (fourthByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0xF) << 0x12 | (secondByte & 0x3F) << 0xC | (thirdByte & 0x3F) << 0x6 | (fourthByte & 0x3F)\n            if (tempCodePoint > 0xFFFF && tempCodePoint < 0x110000) {\n              codePoint = tempCodePoint\n            }\n          }\n      }\n    }\n\n    if (codePoint === null) {\n      // we did not generate a valid codePoint so insert a\n      // replacement char (U+FFFD) and advance only 1 byte\n      codePoint = 0xFFFD\n      bytesPerSequence = 1\n    } else if (codePoint > 0xFFFF) {\n      // encode to utf16 (surrogate pair dance)\n      codePoint -= 0x10000\n      res.push(codePoint >>> 10 & 0x3FF | 0xD800)\n      codePoint = 0xDC00 | codePoint & 0x3FF\n    }\n\n    res.push(codePoint)\n    i += bytesPerSequence\n  }\n\n  return decodeCodePointsArray(res)\n}\n\n// Based on http://stackoverflow.com/a/22747272/680742, the browser with\n// the lowest limit is Chrome, with 0x10000 args.\n// We go 1 magnitude less, for safety\nvar MAX_ARGUMENTS_LENGTH = 0x1000\n\nfunction decodeCodePointsArray (codePoints) {\n  var len = codePoints.length\n  if (len <= MAX_ARGUMENTS_LENGTH) {\n    return String.fromCharCode.apply(String, codePoints) // avoid extra slice()\n  }\n\n  // Decode in chunks to avoid \"call stack size exceeded\".\n  var res = ''\n  var i = 0\n  while (i < len) {\n    res += String.fromCharCode.apply(\n      String,\n      codePoints.slice(i, i += MAX_ARGUMENTS_LENGTH)\n    )\n  }\n  return res\n}\n\nfunction asciiSlice (buf, start, end) {\n  var ret = ''\n  end = Math.min(buf.length, end)\n\n  for (var i = start; i < end; ++i) {\n    ret += String.fromCharCode(buf[i] & 0x7F)\n  }\n  return ret\n}\n\nfunction latin1Slice (buf, start, end) {\n  var ret = ''\n  end = Math.min(buf.length, end)\n\n  for (var i = start; i < end; ++i) {\n    ret += String.fromCharCode(buf[i])\n  }\n  return ret\n}\n\nfunction hexSlice (buf, start, end) {\n  var len = buf.length\n\n  if (!start || start < 0) start = 0\n  if (!end || end < 0 || end > len) end = len\n\n  var out = ''\n  for (var i = start; i < end; ++i) {\n    out += toHex(buf[i])\n  }\n  return out\n}\n\nfunction utf16leSlice (buf, start, end) {\n  var bytes = buf.slice(start, end)\n  var res = ''\n  for (var i = 0; i < bytes.length; i += 2) {\n    res += String.fromCharCode(bytes[i] + bytes[i + 1] * 256)\n  }\n  return res\n}\n\nBuffer.prototype.slice = function slice (start, end) {\n  var len = this.length\n  start = ~~start\n  end = end === undefined ? len : ~~end\n\n  if (start < 0) {\n    start += len\n    if (start < 0) start = 0\n  } else if (start > len) {\n    start = len\n  }\n\n  if (end < 0) {\n    end += len\n    if (end < 0) end = 0\n  } else if (end > len) {\n    end = len\n  }\n\n  if (end < start) end = start\n\n  var newBuf\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    newBuf = this.subarray(start, end)\n    newBuf.__proto__ = Buffer.prototype\n  } else {\n    var sliceLen = end - start\n    newBuf = new Buffer(sliceLen, undefined)\n    for (var i = 0; i < sliceLen; ++i) {\n      newBuf[i] = this[i + start]\n    }\n  }\n\n  return newBuf\n}\n\n/*\n * Need to make sure that buffer isn't trying to write out of bounds.\n */\nfunction checkOffset (offset, ext, length) {\n  if ((offset % 1) !== 0 || offset < 0) throw new RangeError('offset is not uint')\n  if (offset + ext > length) throw new RangeError('Trying to access beyond buffer length')\n}\n\nBuffer.prototype.readUIntLE = function readUIntLE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  var val = this[offset]\n  var mul = 1\n  var i = 0\n  while (++i < byteLength && (mul *= 0x100)) {\n    val += this[offset + i] * mul\n  }\n\n  return val\n}\n\nBuffer.prototype.readUIntBE = function readUIntBE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) {\n    checkOffset(offset, byteLength, this.length)\n  }\n\n  var val = this[offset + --byteLength]\n  var mul = 1\n  while (byteLength > 0 && (mul *= 0x100)) {\n    val += this[offset + --byteLength] * mul\n  }\n\n  return val\n}\n\nBuffer.prototype.readUInt8 = function readUInt8 (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 1, this.length)\n  return this[offset]\n}\n\nBuffer.prototype.readUInt16LE = function readUInt16LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  return this[offset] | (this[offset + 1] << 8)\n}\n\nBuffer.prototype.readUInt16BE = function readUInt16BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  return (this[offset] << 8) | this[offset + 1]\n}\n\nBuffer.prototype.readUInt32LE = function readUInt32LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return ((this[offset]) |\n      (this[offset + 1] << 8) |\n      (this[offset + 2] << 16)) +\n      (this[offset + 3] * 0x1000000)\n}\n\nBuffer.prototype.readUInt32BE = function readUInt32BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset] * 0x1000000) +\n    ((this[offset + 1] << 16) |\n    (this[offset + 2] << 8) |\n    this[offset + 3])\n}\n\nBuffer.prototype.readIntLE = function readIntLE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  var val = this[offset]\n  var mul = 1\n  var i = 0\n  while (++i < byteLength && (mul *= 0x100)) {\n    val += this[offset + i] * mul\n  }\n  mul *= 0x80\n\n  if (val >= mul) val -= Math.pow(2, 8 * byteLength)\n\n  return val\n}\n\nBuffer.prototype.readIntBE = function readIntBE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  var i = byteLength\n  var mul = 1\n  var val = this[offset + --i]\n  while (i > 0 && (mul *= 0x100)) {\n    val += this[offset + --i] * mul\n  }\n  mul *= 0x80\n\n  if (val >= mul) val -= Math.pow(2, 8 * byteLength)\n\n  return val\n}\n\nBuffer.prototype.readInt8 = function readInt8 (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 1, this.length)\n  if (!(this[offset] & 0x80)) return (this[offset])\n  return ((0xff - this[offset] + 1) * -1)\n}\n\nBuffer.prototype.readInt16LE = function readInt16LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  var val = this[offset] | (this[offset + 1] << 8)\n  return (val & 0x8000) ? val | 0xFFFF0000 : val\n}\n\nBuffer.prototype.readInt16BE = function readInt16BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  var val = this[offset + 1] | (this[offset] << 8)\n  return (val & 0x8000) ? val | 0xFFFF0000 : val\n}\n\nBuffer.prototype.readInt32LE = function readInt32LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset]) |\n    (this[offset + 1] << 8) |\n    (this[offset + 2] << 16) |\n    (this[offset + 3] << 24)\n}\n\nBuffer.prototype.readInt32BE = function readInt32BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset] << 24) |\n    (this[offset + 1] << 16) |\n    (this[offset + 2] << 8) |\n    (this[offset + 3])\n}\n\nBuffer.prototype.readFloatLE = function readFloatLE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n  return ieee754.read(this, offset, true, 23, 4)\n}\n\nBuffer.prototype.readFloatBE = function readFloatBE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n  return ieee754.read(this, offset, false, 23, 4)\n}\n\nBuffer.prototype.readDoubleLE = function readDoubleLE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 8, this.length)\n  return ieee754.read(this, offset, true, 52, 8)\n}\n\nBuffer.prototype.readDoubleBE = function readDoubleBE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 8, this.length)\n  return ieee754.read(this, offset, false, 52, 8)\n}\n\nfunction checkInt (buf, value, offset, ext, max, min) {\n  if (!Buffer.isBuffer(buf)) throw new TypeError('\"buffer\" argument must be a Buffer instance')\n  if (value > max || value < min) throw new RangeError('\"value\" argument is out of bounds')\n  if (offset + ext > buf.length) throw new RangeError('Index out of range')\n}\n\nBuffer.prototype.writeUIntLE = function writeUIntLE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) {\n    var maxBytes = Math.pow(2, 8 * byteLength) - 1\n    checkInt(this, value, offset, byteLength, maxBytes, 0)\n  }\n\n  var mul = 1\n  var i = 0\n  this[offset] = value & 0xFF\n  while (++i < byteLength && (mul *= 0x100)) {\n    this[offset + i] = (value / mul) & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeUIntBE = function writeUIntBE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) {\n    var maxBytes = Math.pow(2, 8 * byteLength) - 1\n    checkInt(this, value, offset, byteLength, maxBytes, 0)\n  }\n\n  var i = byteLength - 1\n  var mul = 1\n  this[offset + i] = value & 0xFF\n  while (--i >= 0 && (mul *= 0x100)) {\n    this[offset + i] = (value / mul) & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeUInt8 = function writeUInt8 (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 1, 0xff, 0)\n  if (!Buffer.TYPED_ARRAY_SUPPORT) value = Math.floor(value)\n  this[offset] = (value & 0xff)\n  return offset + 1\n}\n\nfunction objectWriteUInt16 (buf, value, offset, littleEndian) {\n  if (value < 0) value = 0xffff + value + 1\n  for (var i = 0, j = Math.min(buf.length - offset, 2); i < j; ++i) {\n    buf[offset + i] = (value & (0xff << (8 * (littleEndian ? i : 1 - i)))) >>>\n      (littleEndian ? i : 1 - i) * 8\n  }\n}\n\nBuffer.prototype.writeUInt16LE = function writeUInt16LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value & 0xff)\n    this[offset + 1] = (value >>> 8)\n  } else {\n    objectWriteUInt16(this, value, offset, true)\n  }\n  return offset + 2\n}\n\nBuffer.prototype.writeUInt16BE = function writeUInt16BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 8)\n    this[offset + 1] = (value & 0xff)\n  } else {\n    objectWriteUInt16(this, value, offset, false)\n  }\n  return offset + 2\n}\n\nfunction objectWriteUInt32 (buf, value, offset, littleEndian) {\n  if (value < 0) value = 0xffffffff + value + 1\n  for (var i = 0, j = Math.min(buf.length - offset, 4); i < j; ++i) {\n    buf[offset + i] = (value >>> (littleEndian ? i : 3 - i) * 8) & 0xff\n  }\n}\n\nBuffer.prototype.writeUInt32LE = function writeUInt32LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset + 3] = (value >>> 24)\n    this[offset + 2] = (value >>> 16)\n    this[offset + 1] = (value >>> 8)\n    this[offset] = (value & 0xff)\n  } else {\n    objectWriteUInt32(this, value, offset, true)\n  }\n  return offset + 4\n}\n\nBuffer.prototype.writeUInt32BE = function writeUInt32BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 24)\n    this[offset + 1] = (value >>> 16)\n    this[offset + 2] = (value >>> 8)\n    this[offset + 3] = (value & 0xff)\n  } else {\n    objectWriteUInt32(this, value, offset, false)\n  }\n  return offset + 4\n}\n\nBuffer.prototype.writeIntLE = function writeIntLE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) {\n    var limit = Math.pow(2, 8 * byteLength - 1)\n\n    checkInt(this, value, offset, byteLength, limit - 1, -limit)\n  }\n\n  var i = 0\n  var mul = 1\n  var sub = 0\n  this[offset] = value & 0xFF\n  while (++i < byteLength && (mul *= 0x100)) {\n    if (value < 0 && sub === 0 && this[offset + i - 1] !== 0) {\n      sub = 1\n    }\n    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeIntBE = function writeIntBE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) {\n    var limit = Math.pow(2, 8 * byteLength - 1)\n\n    checkInt(this, value, offset, byteLength, limit - 1, -limit)\n  }\n\n  var i = byteLength - 1\n  var mul = 1\n  var sub = 0\n  this[offset + i] = value & 0xFF\n  while (--i >= 0 && (mul *= 0x100)) {\n    if (value < 0 && sub === 0 && this[offset + i + 1] !== 0) {\n      sub = 1\n    }\n    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeInt8 = function writeInt8 (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 1, 0x7f, -0x80)\n  if (!Buffer.TYPED_ARRAY_SUPPORT) value = Math.floor(value)\n  if (value < 0) value = 0xff + value + 1\n  this[offset] = (value & 0xff)\n  return offset + 1\n}\n\nBuffer.prototype.writeInt16LE = function writeInt16LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value & 0xff)\n    this[offset + 1] = (value >>> 8)\n  } else {\n    objectWriteUInt16(this, value, offset, true)\n  }\n  return offset + 2\n}\n\nBuffer.prototype.writeInt16BE = function writeInt16BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 8)\n    this[offset + 1] = (value & 0xff)\n  } else {\n    objectWriteUInt16(this, value, offset, false)\n  }\n  return offset + 2\n}\n\nBuffer.prototype.writeInt32LE = function writeInt32LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value & 0xff)\n    this[offset + 1] = (value >>> 8)\n    this[offset + 2] = (value >>> 16)\n    this[offset + 3] = (value >>> 24)\n  } else {\n    objectWriteUInt32(this, value, offset, true)\n  }\n  return offset + 4\n}\n\nBuffer.prototype.writeInt32BE = function writeInt32BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)\n  if (value < 0) value = 0xffffffff + value + 1\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 24)\n    this[offset + 1] = (value >>> 16)\n    this[offset + 2] = (value >>> 8)\n    this[offset + 3] = (value & 0xff)\n  } else {\n    objectWriteUInt32(this, value, offset, false)\n  }\n  return offset + 4\n}\n\nfunction checkIEEE754 (buf, value, offset, ext, max, min) {\n  if (offset + ext > buf.length) throw new RangeError('Index out of range')\n  if (offset < 0) throw new RangeError('Index out of range')\n}\n\nfunction writeFloat (buf, value, offset, littleEndian, noAssert) {\n  if (!noAssert) {\n    checkIEEE754(buf, value, offset, 4, 3.4028234663852886e+38, -3.4028234663852886e+38)\n  }\n  ieee754.write(buf, value, offset, littleEndian, 23, 4)\n  return offset + 4\n}\n\nBuffer.prototype.writeFloatLE = function writeFloatLE (value, offset, noAssert) {\n  return writeFloat(this, value, offset, true, noAssert)\n}\n\nBuffer.prototype.writeFloatBE = function writeFloatBE (value, offset, noAssert) {\n  return writeFloat(this, value, offset, false, noAssert)\n}\n\nfunction writeDouble (buf, value, offset, littleEndian, noAssert) {\n  if (!noAssert) {\n    checkIEEE754(buf, value, offset, 8, 1.7976931348623157E+308, -1.7976931348623157E+308)\n  }\n  ieee754.write(buf, value, offset, littleEndian, 52, 8)\n  return offset + 8\n}\n\nBuffer.prototype.writeDoubleLE = function writeDoubleLE (value, offset, noAssert) {\n  return writeDouble(this, value, offset, true, noAssert)\n}\n\nBuffer.prototype.writeDoubleBE = function writeDoubleBE (value, offset, noAssert) {\n  return writeDouble(this, value, offset, false, noAssert)\n}\n\n// copy(targetBuffer, targetStart=0, sourceStart=0, sourceEnd=buffer.length)\nBuffer.prototype.copy = function copy (target, targetStart, start, end) {\n  if (!start) start = 0\n  if (!end && end !== 0) end = this.length\n  if (targetStart >= target.length) targetStart = target.length\n  if (!targetStart) targetStart = 0\n  if (end > 0 && end < start) end = start\n\n  // Copy 0 bytes; we're done\n  if (end === start) return 0\n  if (target.length === 0 || this.length === 0) return 0\n\n  // Fatal error conditions\n  if (targetStart < 0) {\n    throw new RangeError('targetStart out of bounds')\n  }\n  if (start < 0 || start >= this.length) throw new RangeError('sourceStart out of bounds')\n  if (end < 0) throw new RangeError('sourceEnd out of bounds')\n\n  // Are we oob?\n  if (end > this.length) end = this.length\n  if (target.length - targetStart < end - start) {\n    end = target.length - targetStart + start\n  }\n\n  var len = end - start\n  var i\n\n  if (this === target && start < targetStart && targetStart < end) {\n    // descending copy from end\n    for (i = len - 1; i >= 0; --i) {\n      target[i + targetStart] = this[i + start]\n    }\n  } else if (len < 1000 || !Buffer.TYPED_ARRAY_SUPPORT) {\n    // ascending copy from start\n    for (i = 0; i < len; ++i) {\n      target[i + targetStart] = this[i + start]\n    }\n  } else {\n    Uint8Array.prototype.set.call(\n      target,\n      this.subarray(start, start + len),\n      targetStart\n    )\n  }\n\n  return len\n}\n\n// Usage:\n//    buffer.fill(number[, offset[, end]])\n//    buffer.fill(buffer[, offset[, end]])\n//    buffer.fill(string[, offset[, end]][, encoding])\nBuffer.prototype.fill = function fill (val, start, end, encoding) {\n  // Handle string cases:\n  if (typeof val === 'string') {\n    if (typeof start === 'string') {\n      encoding = start\n      start = 0\n      end = this.length\n    } else if (typeof end === 'string') {\n      encoding = end\n      end = this.length\n    }\n    if (val.length === 1) {\n      var code = val.charCodeAt(0)\n      if (code < 256) {\n        val = code\n      }\n    }\n    if (encoding !== undefined && typeof encoding !== 'string') {\n      throw new TypeError('encoding must be a string')\n    }\n    if (typeof encoding === 'string' && !Buffer.isEncoding(encoding)) {\n      throw new TypeError('Unknown encoding: ' + encoding)\n    }\n  } else if (typeof val === 'number') {\n    val = val & 255\n  }\n\n  // Invalid ranges are not set to a default, so can range check early.\n  if (start < 0 || this.length < start || this.length < end) {\n    throw new RangeError('Out of range index')\n  }\n\n  if (end <= start) {\n    return this\n  }\n\n  start = start >>> 0\n  end = end === undefined ? this.length : end >>> 0\n\n  if (!val) val = 0\n\n  var i\n  if (typeof val === 'number') {\n    for (i = start; i < end; ++i) {\n      this[i] = val\n    }\n  } else {\n    var bytes = Buffer.isBuffer(val)\n      ? val\n      : utf8ToBytes(new Buffer(val, encoding).toString())\n    var len = bytes.length\n    for (i = 0; i < end - start; ++i) {\n      this[i + start] = bytes[i % len]\n    }\n  }\n\n  return this\n}\n\n// HELPER FUNCTIONS\n// ================\n\nvar INVALID_BASE64_RE = /[^+\\/0-9A-Za-z-_]/g\n\nfunction base64clean (str) {\n  // Node strips out invalid characters like \\n and \\t from the string, base64-js does not\n  str = stringtrim(str).replace(INVALID_BASE64_RE, '')\n  // Node converts strings with length < 2 to ''\n  if (str.length < 2) return ''\n  // Node allows for non-padded base64 strings (missing trailing ===), base64-js does not\n  while (str.length % 4 !== 0) {\n    str = str + '='\n  }\n  return str\n}\n\nfunction stringtrim (str) {\n  if (str.trim) return str.trim()\n  return str.replace(/^\\s+|\\s+$/g, '')\n}\n\nfunction toHex (n) {\n  if (n < 16) return '0' + n.toString(16)\n  return n.toString(16)\n}\n\nfunction utf8ToBytes (string, units) {\n  units = units || Infinity\n  var codePoint\n  var length = string.length\n  var leadSurrogate = null\n  var bytes = []\n\n  for (var i = 0; i < length; ++i) {\n    codePoint = string.charCodeAt(i)\n\n    // is surrogate component\n    if (codePoint > 0xD7FF && codePoint < 0xE000) {\n      // last char was a lead\n      if (!leadSurrogate) {\n        // no lead yet\n        if (codePoint > 0xDBFF) {\n          // unexpected trail\n          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n          continue\n        } else if (i + 1 === length) {\n          // unpaired lead\n          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n          continue\n        }\n\n        // valid lead\n        leadSurrogate = codePoint\n\n        continue\n      }\n\n      // 2 leads in a row\n      if (codePoint < 0xDC00) {\n        if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n        leadSurrogate = codePoint\n        continue\n      }\n\n      // valid surrogate pair\n      codePoint = (leadSurrogate - 0xD800 << 10 | codePoint - 0xDC00) + 0x10000\n    } else if (leadSurrogate) {\n      // valid bmp char, but last char was a lead\n      if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n    }\n\n    leadSurrogate = null\n\n    // encode utf8\n    if (codePoint < 0x80) {\n      if ((units -= 1) < 0) break\n      bytes.push(codePoint)\n    } else if (codePoint < 0x800) {\n      if ((units -= 2) < 0) break\n      bytes.push(\n        codePoint >> 0x6 | 0xC0,\n        codePoint & 0x3F | 0x80\n      )\n    } else if (codePoint < 0x10000) {\n      if ((units -= 3) < 0) break\n      bytes.push(\n        codePoint >> 0xC | 0xE0,\n        codePoint >> 0x6 & 0x3F | 0x80,\n        codePoint & 0x3F | 0x80\n      )\n    } else if (codePoint < 0x110000) {\n      if ((units -= 4) < 0) break\n      bytes.push(\n        codePoint >> 0x12 | 0xF0,\n        codePoint >> 0xC & 0x3F | 0x80,\n        codePoint >> 0x6 & 0x3F | 0x80,\n        codePoint & 0x3F | 0x80\n      )\n    } else {\n      throw new Error('Invalid code point')\n    }\n  }\n\n  return bytes\n}\n\nfunction asciiToBytes (str) {\n  var byteArray = []\n  for (var i = 0; i < str.length; ++i) {\n    // Node's code seems to be doing this and not & 0x7F..\n    byteArray.push(str.charCodeAt(i) & 0xFF)\n  }\n  return byteArray\n}\n\nfunction utf16leToBytes (str, units) {\n  var c, hi, lo\n  var byteArray = []\n  for (var i = 0; i < str.length; ++i) {\n    if ((units -= 2) < 0) break\n\n    c = str.charCodeAt(i)\n    hi = c >> 8\n    lo = c % 256\n    byteArray.push(lo)\n    byteArray.push(hi)\n  }\n\n  return byteArray\n}\n\nfunction base64ToBytes (str) {\n  return base64.toByteArray(base64clean(str))\n}\n\nfunction blitBuffer (src, dst, offset, length) {\n  for (var i = 0; i < length; ++i) {\n    if ((i + offset >= dst.length) || (i >= src.length)) break\n    dst[i + offset] = src[i]\n  }\n  return i\n}\n\nfunction isnan (val) {\n  return val !== val // eslint-disable-line no-self-compare\n}\n","/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */\nexports.read = function (buffer, offset, isLE, mLen, nBytes) {\n  var e, m\n  var eLen = (nBytes * 8) - mLen - 1\n  var eMax = (1 << eLen) - 1\n  var eBias = eMax >> 1\n  var nBits = -7\n  var i = isLE ? (nBytes - 1) : 0\n  var d = isLE ? -1 : 1\n  var s = buffer[offset + i]\n\n  i += d\n\n  e = s & ((1 << (-nBits)) - 1)\n  s >>= (-nBits)\n  nBits += eLen\n  for (; nBits > 0; e = (e * 256) + buffer[offset + i], i += d, nBits -= 8) {}\n\n  m = e & ((1 << (-nBits)) - 1)\n  e >>= (-nBits)\n  nBits += mLen\n  for (; nBits > 0; m = (m * 256) + buffer[offset + i], i += d, nBits -= 8) {}\n\n  if (e === 0) {\n    e = 1 - eBias\n  } else if (e === eMax) {\n    return m ? NaN : ((s ? -1 : 1) * Infinity)\n  } else {\n    m = m + Math.pow(2, mLen)\n    e = e - eBias\n  }\n  return (s ? -1 : 1) * m * Math.pow(2, e - mLen)\n}\n\nexports.write = function (buffer, value, offset, isLE, mLen, nBytes) {\n  var e, m, c\n  var eLen = (nBytes * 8) - mLen - 1\n  var eMax = (1 << eLen) - 1\n  var eBias = eMax >> 1\n  var rt = (mLen === 23 ? Math.pow(2, -24) - Math.pow(2, -77) : 0)\n  var i = isLE ? 0 : (nBytes - 1)\n  var d = isLE ? 1 : -1\n  var s = value < 0 || (value === 0 && 1 / value < 0) ? 1 : 0\n\n  value = Math.abs(value)\n\n  if (isNaN(value) || value === Infinity) {\n    m = isNaN(value) ? 1 : 0\n    e = eMax\n  } else {\n    e = Math.floor(Math.log(value) / Math.LN2)\n    if (value * (c = Math.pow(2, -e)) < 1) {\n      e--\n      c *= 2\n    }\n    if (e + eBias >= 1) {\n      value += rt / c\n    } else {\n      value += rt * Math.pow(2, 1 - eBias)\n    }\n    if (value * c >= 2) {\n      e++\n      c /= 2\n    }\n\n    if (e + eBias >= eMax) {\n      m = 0\n      e = eMax\n    } else if (e + eBias >= 1) {\n      m = ((value * c) - 1) * Math.pow(2, mLen)\n      e = e + eBias\n    } else {\n      m = value * Math.pow(2, eBias - 1) * Math.pow(2, mLen)\n      e = 0\n    }\n  }\n\n  for (; mLen >= 8; buffer[offset + i] = m & 0xff, i += d, m /= 256, mLen -= 8) {}\n\n  e = (e << mLen) | m\n  eLen += mLen\n  for (; eLen > 0; buffer[offset + i] = e & 0xff, i += d, e /= 256, eLen -= 8) {}\n\n  buffer[offset + i - d] |= s * 128\n}\n","var toString = {}.toString;\n\nmodule.exports = Array.isArray || function (arr) {\n  return toString.call(arr) == '[object Array]';\n};\n","module.exports = __WEBPACK_EXTERNAL_MODULE__146__;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","// Copyright (c) Martin Renou\n// Distributed under the terms of the Modified BSD License.\n\nconst data = require('../package.json');\n\n/**\n * The _model_module_version/_view_module_version this package implements.\n *\n * The html widget manager assumes that this is the same as the npm package\n * version number.\n */\nexport const MODULE_VERSION = data.version;\n\n/*\n * The current package name.\n */\nexport const MODULE_NAME = data.name;\n","export function rotatePoints(points, center, degrees) {\n    if (points && points.length) {\n        const [cx, cy] = center;\n        const angle = (Math.PI / 180) * degrees;\n        const cos = Math.cos(angle);\n        const sin = Math.sin(angle);\n        points.forEach((p) => {\n            const [x, y] = p;\n            p[0] = ((x - cx) * cos) - ((y - cy) * sin) + cx;\n            p[1] = ((x - cx) * sin) + ((y - cy) * cos) + cy;\n        });\n    }\n}\nexport function rotateLines(lines, center, degrees) {\n    const points = [];\n    lines.forEach((line) => points.push(...line));\n    rotatePoints(points, center, degrees);\n}\nexport function lineLength(line) {\n    const p1 = line[0];\n    const p2 = line[1];\n    return Math.sqrt(Math.pow(p1[0] - p2[0], 2) + Math.pow(p1[1] - p2[1], 2));\n}\n","import { rotatePoints, rotateLines } from '../geometry';\nexport function polygonHachureLines(polygonList, o) {\n    const angle = o.hachureAngle + 90;\n    let gap = o.hachureGap;\n    if (gap < 0) {\n        gap = o.strokeWidth * 4;\n    }\n    gap = Math.max(gap, 0.1);\n    const rotationCenter = [0, 0];\n    if (angle) {\n        for (const polygon of polygonList) {\n            rotatePoints(polygon, rotationCenter, angle);\n        }\n    }\n    const lines = straightHachureLines(polygonList, gap);\n    if (angle) {\n        for (const polygon of polygonList) {\n            rotatePoints(polygon, rotationCenter, -angle);\n        }\n        rotateLines(lines, rotationCenter, -angle);\n    }\n    return lines;\n}\nfunction straightHachureLines(polygonList, gap) {\n    const vertexArray = [];\n    for (const polygon of polygonList) {\n        const vertices = [...polygon];\n        if (vertices[0].join(',') !== vertices[vertices.length - 1].join(',')) {\n            vertices.push([vertices[0][0], vertices[0][1]]);\n        }\n        if (vertices.length > 2) {\n            vertexArray.push(vertices);\n        }\n    }\n    const lines = [];\n    gap = Math.max(gap, 0.1);\n    // Create sorted edges table\n    const edges = [];\n    for (const vertices of vertexArray) {\n        for (let i = 0; i < vertices.length - 1; i++) {\n            const p1 = vertices[i];\n            const p2 = vertices[i + 1];\n            if (p1[1] !== p2[1]) {\n                const ymin = Math.min(p1[1], p2[1]);\n                edges.push({\n                    ymin,\n                    ymax: Math.max(p1[1], p2[1]),\n                    x: ymin === p1[1] ? p1[0] : p2[0],\n                    islope: (p2[0] - p1[0]) / (p2[1] - p1[1]),\n                });\n            }\n        }\n    }\n    edges.sort((e1, e2) => {\n        if (e1.ymin < e2.ymin) {\n            return -1;\n        }\n        if (e1.ymin > e2.ymin) {\n            return 1;\n        }\n        if (e1.x < e2.x) {\n            return -1;\n        }\n        if (e1.x > e2.x) {\n            return 1;\n        }\n        if (e1.ymax === e2.ymax) {\n            return 0;\n        }\n        return (e1.ymax - e2.ymax) / Math.abs((e1.ymax - e2.ymax));\n    });\n    if (!edges.length) {\n        return lines;\n    }\n    // Start scanning\n    let activeEdges = [];\n    let y = edges[0].ymin;\n    while (activeEdges.length || edges.length) {\n        if (edges.length) {\n            let ix = -1;\n            for (let i = 0; i < edges.length; i++) {\n                if (edges[i].ymin > y) {\n                    break;\n                }\n                ix = i;\n            }\n            const removed = edges.splice(0, ix + 1);\n            removed.forEach((edge) => {\n                activeEdges.push({ s: y, edge });\n            });\n        }\n        activeEdges = activeEdges.filter((ae) => {\n            if (ae.edge.ymax <= y) {\n                return false;\n            }\n            return true;\n        });\n        activeEdges.sort((ae1, ae2) => {\n            if (ae1.edge.x === ae2.edge.x) {\n                return 0;\n            }\n            return (ae1.edge.x - ae2.edge.x) / Math.abs((ae1.edge.x - ae2.edge.x));\n        });\n        // fill between the edges\n        if (activeEdges.length > 1) {\n            for (let i = 0; i < activeEdges.length; i = i + 2) {\n                const nexti = i + 1;\n                if (nexti >= activeEdges.length) {\n                    break;\n                }\n                const ce = activeEdges[i].edge;\n                const ne = activeEdges[nexti].edge;\n                lines.push([\n                    [Math.round(ce.x), y],\n                    [Math.round(ne.x), y],\n                ]);\n            }\n        }\n        y += gap;\n        activeEdges.forEach((ae) => {\n            ae.edge.x = ae.edge.x + (gap * ae.edge.islope);\n        });\n    }\n    return lines;\n}\n","import { polygonHachureLines } from './scan-line-hachure';\nexport class HachureFiller {\n    constructor(helper) {\n        this.helper = helper;\n    }\n    fillPolygons(polygonList, o) {\n        return this._fillPolygons(polygonList, o);\n    }\n    _fillPolygons(polygonList, o) {\n        const lines = polygonHachureLines(polygonList, o);\n        const ops = this.renderLines(lines, o);\n        return { type: 'fillSketch', ops };\n    }\n    renderLines(lines, o) {\n        const ops = [];\n        for (const line of lines) {\n            ops.push(...this.helper.doubleLineOps(line[0][0], line[0][1], line[1][0], line[1][1], o));\n        }\n        return ops;\n    }\n}\n","import { HachureFiller } from './hachure-filler';\nimport { polygonHachureLines } from './scan-line-hachure';\nimport { lineLength } from '../geometry';\nexport class ZigZagFiller extends HachureFiller {\n    fillPolygons(polygonList, o) {\n        let gap = o.hachureGap;\n        if (gap < 0) {\n            gap = o.strokeWidth * 4;\n        }\n        gap = Math.max(gap, 0.1);\n        const o2 = Object.assign({}, o, { hachureGap: gap });\n        const lines = polygonHachureLines(polygonList, o2);\n        const zigZagAngle = (Math.PI / 180) * o.hachureAngle;\n        const zigzagLines = [];\n        const dgx = gap * 0.5 * Math.cos(zigZagAngle);\n        const dgy = gap * 0.5 * Math.sin(zigZagAngle);\n        for (const [p1, p2] of lines) {\n            if (lineLength([p1, p2])) {\n                zigzagLines.push([\n                    [p1[0] - dgx, p1[1] + dgy],\n                    [...p2],\n                ], [\n                    [p1[0] + dgx, p1[1] - dgy],\n                    [...p2],\n                ]);\n            }\n        }\n        const ops = this.renderLines(zigzagLines, o);\n        return { type: 'fillSketch', ops };\n    }\n}\n","import { HachureFiller } from './hachure-filler';\nexport class HatchFiller extends HachureFiller {\n    fillPolygons(polygonList, o) {\n        const set = this._fillPolygons(polygonList, o);\n        const o2 = Object.assign({}, o, { hachureAngle: o.hachureAngle + 90 });\n        const set2 = this._fillPolygons(polygonList, o2);\n        set.ops = set.ops.concat(set2.ops);\n        return set;\n    }\n}\n","import { lineLength } from '../geometry';\nimport { polygonHachureLines } from './scan-line-hachure';\nexport class DotFiller {\n    constructor(helper) {\n        this.helper = helper;\n    }\n    fillPolygons(polygonList, o) {\n        o = Object.assign({}, o, { hachureAngle: 0 });\n        const lines = polygonHachureLines(polygonList, o);\n        return this.dotsOnLines(lines, o);\n    }\n    dotsOnLines(lines, o) {\n        const ops = [];\n        let gap = o.hachureGap;\n        if (gap < 0) {\n            gap = o.strokeWidth * 4;\n        }\n        gap = Math.max(gap, 0.1);\n        let fweight = o.fillWeight;\n        if (fweight < 0) {\n            fweight = o.strokeWidth / 2;\n        }\n        const ro = gap / 4;\n        for (const line of lines) {\n            const length = lineLength(line);\n            const dl = length / gap;\n            const count = Math.ceil(dl) - 1;\n            const offset = length - (count * gap);\n            const x = ((line[0][0] + line[1][0]) / 2) - (gap / 4);\n            const minY = Math.min(line[0][1], line[1][1]);\n            for (let i = 0; i < count; i++) {\n                const y = minY + offset + (i * gap);\n                const cx = (x - ro) + Math.random() * 2 * ro;\n                const cy = (y - ro) + Math.random() * 2 * ro;\n                const el = this.helper.ellipse(cx, cy, fweight, fweight, o);\n                ops.push(...el.ops);\n            }\n        }\n        return { type: 'fillSketch', ops };\n    }\n}\n","import { lineLength } from '../geometry';\nimport { polygonHachureLines } from './scan-line-hachure';\nexport class DashedFiller {\n    constructor(helper) {\n        this.helper = helper;\n    }\n    fillPolygons(polygonList, o) {\n        const lines = polygonHachureLines(polygonList, o);\n        return { type: 'fillSketch', ops: this.dashedLine(lines, o) };\n    }\n    dashedLine(lines, o) {\n        const offset = o.dashOffset < 0 ? (o.hachureGap < 0 ? (o.strokeWidth * 4) : o.hachureGap) : o.dashOffset;\n        const gap = o.dashGap < 0 ? (o.hachureGap < 0 ? (o.strokeWidth * 4) : o.hachureGap) : o.dashGap;\n        const ops = [];\n        lines.forEach((line) => {\n            const length = lineLength(line);\n            const count = Math.floor(length / (offset + gap));\n            const startOffset = (length + gap - (count * (offset + gap))) / 2;\n            let p1 = line[0];\n            let p2 = line[1];\n            if (p1[0] > p2[0]) {\n                p1 = line[1];\n                p2 = line[0];\n            }\n            const alpha = Math.atan((p2[1] - p1[1]) / (p2[0] - p1[0]));\n            for (let i = 0; i < count; i++) {\n                const lstart = i * (offset + gap);\n                const lend = lstart + offset;\n                const start = [p1[0] + (lstart * Math.cos(alpha)) + (startOffset * Math.cos(alpha)), p1[1] + lstart * Math.sin(alpha) + (startOffset * Math.sin(alpha))];\n                const end = [p1[0] + (lend * Math.cos(alpha)) + (startOffset * Math.cos(alpha)), p1[1] + (lend * Math.sin(alpha)) + (startOffset * Math.sin(alpha))];\n                ops.push(...this.helper.doubleLineOps(start[0], start[1], end[0], end[1], o));\n            }\n        });\n        return ops;\n    }\n}\n","import { lineLength } from '../geometry';\nimport { polygonHachureLines } from './scan-line-hachure';\nexport class ZigZagLineFiller {\n    constructor(helper) {\n        this.helper = helper;\n    }\n    fillPolygons(polygonList, o) {\n        const gap = o.hachureGap < 0 ? (o.strokeWidth * 4) : o.hachureGap;\n        const zo = o.zigzagOffset < 0 ? gap : o.zigzagOffset;\n        o = Object.assign({}, o, { hachureGap: gap + zo });\n        const lines = polygonHachureLines(polygonList, o);\n        return { type: 'fillSketch', ops: this.zigzagLines(lines, zo, o) };\n    }\n    zigzagLines(lines, zo, o) {\n        const ops = [];\n        lines.forEach((line) => {\n            const length = lineLength(line);\n            const count = Math.round(length / (2 * zo));\n            let p1 = line[0];\n            let p2 = line[1];\n            if (p1[0] > p2[0]) {\n                p1 = line[1];\n                p2 = line[0];\n            }\n            const alpha = Math.atan((p2[1] - p1[1]) / (p2[0] - p1[0]));\n            for (let i = 0; i < count; i++) {\n                const lstart = i * 2 * zo;\n                const lend = (i + 1) * 2 * zo;\n                const dz = Math.sqrt(2 * Math.pow(zo, 2));\n                const start = [p1[0] + (lstart * Math.cos(alpha)), p1[1] + lstart * Math.sin(alpha)];\n                const end = [p1[0] + (lend * Math.cos(alpha)), p1[1] + (lend * Math.sin(alpha))];\n                const middle = [start[0] + dz * Math.cos(alpha + Math.PI / 4), start[1] + dz * Math.sin(alpha + Math.PI / 4)];\n                ops.push(...this.helper.doubleLineOps(start[0], start[1], middle[0], middle[1], o), ...this.helper.doubleLineOps(middle[0], middle[1], end[0], end[1], o));\n            }\n        });\n        return ops;\n    }\n}\n","import { HachureFiller } from './hachure-filler';\nimport { ZigZagFiller } from './zigzag-filler';\nimport { HatchFiller } from './hatch-filler';\nimport { DotFiller } from './dot-filler';\nimport { DashedFiller } from './dashed-filler';\nimport { ZigZagLineFiller } from './zigzag-line-filler';\nconst fillers = {};\nexport function getFiller(o, helper) {\n    let fillerName = o.fillStyle || 'hachure';\n    if (!fillers[fillerName]) {\n        switch (fillerName) {\n            case 'zigzag':\n                if (!fillers[fillerName]) {\n                    fillers[fillerName] = new ZigZagFiller(helper);\n                }\n                break;\n            case 'cross-hatch':\n                if (!fillers[fillerName]) {\n                    fillers[fillerName] = new HatchFiller(helper);\n                }\n                break;\n            case 'dots':\n                if (!fillers[fillerName]) {\n                    fillers[fillerName] = new DotFiller(helper);\n                }\n                break;\n            case 'dashed':\n                if (!fillers[fillerName]) {\n                    fillers[fillerName] = new DashedFiller(helper);\n                }\n                break;\n            case 'zigzag-line':\n                if (!fillers[fillerName]) {\n                    fillers[fillerName] = new ZigZagLineFiller(helper);\n                }\n                break;\n            case 'hachure':\n            default:\n                fillerName = 'hachure';\n                if (!fillers[fillerName]) {\n                    fillers[fillerName] = new HachureFiller(helper);\n                }\n                break;\n        }\n    }\n    return fillers[fillerName];\n}\n","export function randomSeed() {\n    return Math.floor(Math.random() * 2 ** 31);\n}\nexport class Random {\n    constructor(seed) {\n        this.seed = seed;\n    }\n    next() {\n        if (this.seed) {\n            return ((2 ** 31 - 1) & (this.seed = Math.imul(48271, this.seed))) / 2 ** 31;\n        }\n        else {\n            return Math.random();\n        }\n    }\n}\n","const COMMAND = 0;\nconst NUMBER = 1;\nconst EOD = 2;\nconst PARAMS = { A: 7, a: 7, C: 6, c: 6, H: 1, h: 1, L: 2, l: 2, M: 2, m: 2, Q: 4, q: 4, S: 4, s: 4, T: 2, t: 2, V: 1, v: 1, Z: 0, z: 0 };\nfunction tokenize(d) {\n    const tokens = new Array();\n    while (d !== '') {\n        if (d.match(/^([ \\t\\r\\n,]+)/)) {\n            d = d.substr(RegExp.$1.length);\n        }\n        else if (d.match(/^([aAcChHlLmMqQsStTvVzZ])/)) {\n            tokens[tokens.length] = { type: COMMAND, text: RegExp.$1 };\n            d = d.substr(RegExp.$1.length);\n        }\n        else if (d.match(/^(([-+]?[0-9]+(\\.[0-9]*)?|[-+]?\\.[0-9]+)([eE][-+]?[0-9]+)?)/)) {\n            tokens[tokens.length] = { type: NUMBER, text: `${parseFloat(RegExp.$1)}` };\n            d = d.substr(RegExp.$1.length);\n        }\n        else {\n            return [];\n        }\n    }\n    tokens[tokens.length] = { type: EOD, text: '' };\n    return tokens;\n}\nfunction isType(token, type) {\n    return token.type === type;\n}\nexport function parsePath(d) {\n    const segments = [];\n    const tokens = tokenize(d);\n    let mode = 'BOD';\n    let index = 0;\n    let token = tokens[index];\n    while (!isType(token, EOD)) {\n        let paramsCount = 0;\n        const params = [];\n        if (mode === 'BOD') {\n            if (token.text === 'M' || token.text === 'm') {\n                index++;\n                paramsCount = PARAMS[token.text];\n                mode = token.text;\n            }\n            else {\n                return parsePath('M0,0' + d);\n            }\n        }\n        else if (isType(token, NUMBER)) {\n            paramsCount = PARAMS[mode];\n        }\n        else {\n            index++;\n            paramsCount = PARAMS[token.text];\n            mode = token.text;\n        }\n        if ((index + paramsCount) < tokens.length) {\n            for (let i = index; i < index + paramsCount; i++) {\n                const numbeToken = tokens[i];\n                if (isType(numbeToken, NUMBER)) {\n                    params[params.length] = +numbeToken.text;\n                }\n                else {\n                    throw new Error('Param not a number: ' + mode + ',' + numbeToken.text);\n                }\n            }\n            if (typeof PARAMS[mode] === 'number') {\n                const segment = { key: mode, data: params };\n                segments.push(segment);\n                index += paramsCount;\n                token = tokens[index];\n                if (mode === 'M')\n                    mode = 'L';\n                if (mode === 'm')\n                    mode = 'l';\n            }\n            else {\n                throw new Error('Bad segment: ' + mode);\n            }\n        }\n        else {\n            throw new Error('Path data ended short');\n        }\n    }\n    return segments;\n}\nexport function serialize(segments) {\n    const tokens = [];\n    for (const { key, data } of segments) {\n        tokens.push(key);\n        switch (key) {\n            case 'C':\n            case 'c':\n                tokens.push(data[0], `${data[1]},`, data[2], `${data[3]},`, data[4], data[5]);\n                break;\n            case 'S':\n            case 's':\n            case 'Q':\n            case 'q':\n                tokens.push(data[0], `${data[1]},`, data[2], data[3]);\n                break;\n            default:\n                tokens.push(...data);\n                break;\n        }\n    }\n    return tokens.join(' ');\n}\n","// Translate relative commands to absolute commands\nexport function absolutize(segments) {\n    let cx = 0, cy = 0;\n    let subx = 0, suby = 0;\n    const out = [];\n    for (const { key, data } of segments) {\n        switch (key) {\n            case 'M':\n                out.push({ key: 'M', data: [...data] });\n                [cx, cy] = data;\n                [subx, suby] = data;\n                break;\n            case 'm':\n                cx += data[0];\n                cy += data[1];\n                out.push({ key: 'M', data: [cx, cy] });\n                subx = cx;\n                suby = cy;\n                break;\n            case 'L':\n                out.push({ key: 'L', data: [...data] });\n                [cx, cy] = data;\n                break;\n            case 'l':\n                cx += data[0];\n                cy += data[1];\n                out.push({ key: 'L', data: [cx, cy] });\n                break;\n            case 'C':\n                out.push({ key: 'C', data: [...data] });\n                cx = data[4];\n                cy = data[5];\n                break;\n            case 'c': {\n                const newdata = data.map((d, i) => (i % 2) ? (d + cy) : (d + cx));\n                out.push({ key: 'C', data: newdata });\n                cx = newdata[4];\n                cy = newdata[5];\n                break;\n            }\n            case 'Q':\n                out.push({ key: 'Q', data: [...data] });\n                cx = data[2];\n                cy = data[3];\n                break;\n            case 'q': {\n                const newdata = data.map((d, i) => (i % 2) ? (d + cy) : (d + cx));\n                out.push({ key: 'Q', data: newdata });\n                cx = newdata[2];\n                cy = newdata[3];\n                break;\n            }\n            case 'A':\n                out.push({ key: 'A', data: [...data] });\n                cx = data[5];\n                cy = data[6];\n                break;\n            case 'a':\n                cx += data[5];\n                cy += data[6];\n                out.push({ key: 'A', data: [data[0], data[1], data[2], data[3], data[4], cx, cy] });\n                break;\n            case 'H':\n                out.push({ key: 'H', data: [...data] });\n                cx = data[0];\n                break;\n            case 'h':\n                cx += data[0];\n                out.push({ key: 'H', data: [cx] });\n                break;\n            case 'V':\n                out.push({ key: 'V', data: [...data] });\n                cy = data[0];\n                break;\n            case 'v':\n                cy += data[0];\n                out.push({ key: 'V', data: [cy] });\n                break;\n            case 'S':\n                out.push({ key: 'S', data: [...data] });\n                cx = data[2];\n                cy = data[3];\n                break;\n            case 's': {\n                const newdata = data.map((d, i) => (i % 2) ? (d + cy) : (d + cx));\n                out.push({ key: 'S', data: newdata });\n                cx = newdata[2];\n                cy = newdata[3];\n                break;\n            }\n            case 'T':\n                out.push({ key: 'T', data: [...data] });\n                cx = data[0];\n                cy = data[1];\n                break;\n            case 't':\n                cx += data[0];\n                cy += data[1];\n                out.push({ key: 'T', data: [cx, cy] });\n                break;\n            case 'Z':\n            case 'z':\n                out.push({ key: 'Z', data: [] });\n                cx = subx;\n                cy = suby;\n                break;\n        }\n    }\n    return out;\n}\n","// Normalize path to include only M, L, C, and Z commands\nexport function normalize(segments) {\n    const out = [];\n    let lastType = '';\n    let cx = 0, cy = 0;\n    let subx = 0, suby = 0;\n    let lcx = 0, lcy = 0;\n    for (const { key, data } of segments) {\n        switch (key) {\n            case 'M':\n                out.push({ key: 'M', data: [...data] });\n                [cx, cy] = data;\n                [subx, suby] = data;\n                break;\n            case 'C':\n                out.push({ key: 'C', data: [...data] });\n                cx = data[4];\n                cy = data[5];\n                lcx = data[2];\n                lcy = data[3];\n                break;\n            case 'L':\n                out.push({ key: 'L', data: [...data] });\n                [cx, cy] = data;\n                break;\n            case 'H':\n                cx = data[0];\n                out.push({ key: 'L', data: [cx, cy] });\n                break;\n            case 'V':\n                cy = data[0];\n                out.push({ key: 'L', data: [cx, cy] });\n                break;\n            case 'S': {\n                let cx1 = 0, cy1 = 0;\n                if (lastType === 'C' || lastType === 'S') {\n                    cx1 = cx + (cx - lcx);\n                    cy1 = cy + (cy - lcy);\n                }\n                else {\n                    cx1 = cx;\n                    cy1 = cy;\n                }\n                out.push({ key: 'C', data: [cx1, cy1, ...data] });\n                lcx = data[0];\n                lcy = data[1];\n                cx = data[2];\n                cy = data[3];\n                break;\n            }\n            case 'T': {\n                const [x, y] = data;\n                let x1 = 0, y1 = 0;\n                if (lastType === 'Q' || lastType === 'T') {\n                    x1 = cx + (cx - lcx);\n                    y1 = cy + (cy - lcy);\n                }\n                else {\n                    x1 = cx;\n                    y1 = cy;\n                }\n                const cx1 = cx + 2 * (x1 - cx) / 3;\n                const cy1 = cy + 2 * (y1 - cy) / 3;\n                const cx2 = x + 2 * (x1 - x) / 3;\n                const cy2 = y + 2 * (y1 - y) / 3;\n                out.push({ key: 'C', data: [cx1, cy1, cx2, cy2, x, y] });\n                lcx = x1;\n                lcy = y1;\n                cx = x;\n                cy = y;\n                break;\n            }\n            case 'Q': {\n                const [x1, y1, x, y] = data;\n                const cx1 = cx + 2 * (x1 - cx) / 3;\n                const cy1 = cy + 2 * (y1 - cy) / 3;\n                const cx2 = x + 2 * (x1 - x) / 3;\n                const cy2 = y + 2 * (y1 - y) / 3;\n                out.push({ key: 'C', data: [cx1, cy1, cx2, cy2, x, y] });\n                lcx = x1;\n                lcy = y1;\n                cx = x;\n                cy = y;\n                break;\n            }\n            case 'A': {\n                const r1 = Math.abs(data[0]);\n                const r2 = Math.abs(data[1]);\n                const angle = data[2];\n                const largeArcFlag = data[3];\n                const sweepFlag = data[4];\n                const x = data[5];\n                const y = data[6];\n                if (r1 === 0 || r2 === 0) {\n                    out.push({ key: 'C', data: [cx, cy, x, y, x, y] });\n                    cx = x;\n                    cy = y;\n                }\n                else {\n                    if (cx !== x || cy !== y) {\n                        const curves = arcToCubicCurves(cx, cy, x, y, r1, r2, angle, largeArcFlag, sweepFlag);\n                        curves.forEach(function (curve) {\n                            out.push({ key: 'C', data: curve });\n                        });\n                        cx = x;\n                        cy = y;\n                    }\n                }\n                break;\n            }\n            case 'Z':\n                out.push({ key: 'Z', data: [] });\n                cx = subx;\n                cy = suby;\n                break;\n        }\n        lastType = key;\n    }\n    return out;\n}\nfunction degToRad(degrees) {\n    return (Math.PI * degrees) / 180;\n}\nfunction rotate(x, y, angleRad) {\n    const X = x * Math.cos(angleRad) - y * Math.sin(angleRad);\n    const Y = x * Math.sin(angleRad) + y * Math.cos(angleRad);\n    return [X, Y];\n}\nfunction arcToCubicCurves(x1, y1, x2, y2, r1, r2, angle, largeArcFlag, sweepFlag, recursive) {\n    const angleRad = degToRad(angle);\n    let params = [];\n    let f1 = 0, f2 = 0, cx = 0, cy = 0;\n    if (recursive) {\n        [f1, f2, cx, cy] = recursive;\n    }\n    else {\n        [x1, y1] = rotate(x1, y1, -angleRad);\n        [x2, y2] = rotate(x2, y2, -angleRad);\n        const x = (x1 - x2) / 2;\n        const y = (y1 - y2) / 2;\n        let h = (x * x) / (r1 * r1) + (y * y) / (r2 * r2);\n        if (h > 1) {\n            h = Math.sqrt(h);\n            r1 = h * r1;\n            r2 = h * r2;\n        }\n        const sign = (largeArcFlag === sweepFlag) ? -1 : 1;\n        const r1Pow = r1 * r1;\n        const r2Pow = r2 * r2;\n        const left = r1Pow * r2Pow - r1Pow * y * y - r2Pow * x * x;\n        const right = r1Pow * y * y + r2Pow * x * x;\n        const k = sign * Math.sqrt(Math.abs(left / right));\n        cx = k * r1 * y / r2 + (x1 + x2) / 2;\n        cy = k * -r2 * x / r1 + (y1 + y2) / 2;\n        f1 = Math.asin(parseFloat(((y1 - cy) / r2).toFixed(9)));\n        f2 = Math.asin(parseFloat(((y2 - cy) / r2).toFixed(9)));\n        if (x1 < cx) {\n            f1 = Math.PI - f1;\n        }\n        if (x2 < cx) {\n            f2 = Math.PI - f2;\n        }\n        if (f1 < 0) {\n            f1 = Math.PI * 2 + f1;\n        }\n        if (f2 < 0) {\n            f2 = Math.PI * 2 + f2;\n        }\n        if (sweepFlag && f1 > f2) {\n            f1 = f1 - Math.PI * 2;\n        }\n        if (!sweepFlag && f2 > f1) {\n            f2 = f2 - Math.PI * 2;\n        }\n    }\n    let df = f2 - f1;\n    if (Math.abs(df) > (Math.PI * 120 / 180)) {\n        const f2old = f2;\n        const x2old = x2;\n        const y2old = y2;\n        if (sweepFlag && f2 > f1) {\n            f2 = f1 + (Math.PI * 120 / 180) * (1);\n        }\n        else {\n            f2 = f1 + (Math.PI * 120 / 180) * (-1);\n        }\n        x2 = cx + r1 * Math.cos(f2);\n        y2 = cy + r2 * Math.sin(f2);\n        params = arcToCubicCurves(x2, y2, x2old, y2old, r1, r2, angle, 0, sweepFlag, [f2, f2old, cx, cy]);\n    }\n    df = f2 - f1;\n    const c1 = Math.cos(f1);\n    const s1 = Math.sin(f1);\n    const c2 = Math.cos(f2);\n    const s2 = Math.sin(f2);\n    const t = Math.tan(df / 4);\n    const hx = 4 / 3 * r1 * t;\n    const hy = 4 / 3 * r2 * t;\n    const m1 = [x1, y1];\n    const m2 = [x1 + hx * s1, y1 - hy * c1];\n    const m3 = [x2 + hx * s2, y2 - hy * c2];\n    const m4 = [x2, y2];\n    m2[0] = 2 * m1[0] - m2[0];\n    m2[1] = 2 * m1[1] - m2[1];\n    if (recursive) {\n        return [m2, m3, m4].concat(params);\n    }\n    else {\n        params = [m2, m3, m4].concat(params);\n        const curves = [];\n        for (let i = 0; i < params.length; i += 3) {\n            const r1 = rotate(params[i][0], params[i][1], angleRad);\n            const r2 = rotate(params[i + 1][0], params[i + 1][1], angleRad);\n            const r3 = rotate(params[i + 2][0], params[i + 2][1], angleRad);\n            curves.push([r1[0], r1[1], r2[0], r2[1], r3[0], r3[1]]);\n        }\n        return curves;\n    }\n}\n","import { getFiller } from './fillers/filler.js';\nimport { Random } from './math.js';\nimport { parsePath, normalize, absolutize } from 'path-data-parser';\nconst helper = {\n    randOffset,\n    randOffsetWithRange,\n    ellipse,\n    doubleLineOps: doubleLineFillOps,\n};\nexport function line(x1, y1, x2, y2, o) {\n    return { type: 'path', ops: _doubleLine(x1, y1, x2, y2, o) };\n}\nexport function linearPath(points, close, o) {\n    const len = (points || []).length;\n    if (len > 2) {\n        const ops = [];\n        for (let i = 0; i < (len - 1); i++) {\n            ops.push(..._doubleLine(points[i][0], points[i][1], points[i + 1][0], points[i + 1][1], o));\n        }\n        if (close) {\n            ops.push(..._doubleLine(points[len - 1][0], points[len - 1][1], points[0][0], points[0][1], o));\n        }\n        return { type: 'path', ops };\n    }\n    else if (len === 2) {\n        return line(points[0][0], points[0][1], points[1][0], points[1][1], o);\n    }\n    return { type: 'path', ops: [] };\n}\nexport function polygon(points, o) {\n    return linearPath(points, true, o);\n}\nexport function rectangle(x, y, width, height, o) {\n    const points = [\n        [x, y],\n        [x + width, y],\n        [x + width, y + height],\n        [x, y + height],\n    ];\n    return polygon(points, o);\n}\nexport function curve(points, o) {\n    let o1 = _curveWithOffset(points, 1 * (1 + o.roughness * 0.2), o);\n    if (!o.disableMultiStroke) {\n        const o2 = _curveWithOffset(points, 1.5 * (1 + o.roughness * 0.22), cloneOptionsAlterSeed(o));\n        o1 = o1.concat(o2);\n    }\n    return { type: 'path', ops: o1 };\n}\nexport function ellipse(x, y, width, height, o) {\n    const params = generateEllipseParams(width, height, o);\n    return ellipseWithParams(x, y, o, params).opset;\n}\nexport function generateEllipseParams(width, height, o) {\n    const psq = Math.sqrt(Math.PI * 2 * Math.sqrt((Math.pow(width / 2, 2) + Math.pow(height / 2, 2)) / 2));\n    const stepCount = Math.ceil(Math.max(o.curveStepCount, (o.curveStepCount / Math.sqrt(200)) * psq));\n    const increment = (Math.PI * 2) / stepCount;\n    let rx = Math.abs(width / 2);\n    let ry = Math.abs(height / 2);\n    const curveFitRandomness = 1 - o.curveFitting;\n    rx += _offsetOpt(rx * curveFitRandomness, o);\n    ry += _offsetOpt(ry * curveFitRandomness, o);\n    return { increment, rx, ry };\n}\nexport function ellipseWithParams(x, y, o, ellipseParams) {\n    const [ap1, cp1] = _computeEllipsePoints(ellipseParams.increment, x, y, ellipseParams.rx, ellipseParams.ry, 1, ellipseParams.increment * _offset(0.1, _offset(0.4, 1, o), o), o);\n    let o1 = _curve(ap1, null, o);\n    if ((!o.disableMultiStroke) && (o.roughness !== 0)) {\n        const [ap2] = _computeEllipsePoints(ellipseParams.increment, x, y, ellipseParams.rx, ellipseParams.ry, 1.5, 0, o);\n        const o2 = _curve(ap2, null, o);\n        o1 = o1.concat(o2);\n    }\n    return {\n        estimatedPoints: cp1,\n        opset: { type: 'path', ops: o1 },\n    };\n}\nexport function arc(x, y, width, height, start, stop, closed, roughClosure, o) {\n    const cx = x;\n    const cy = y;\n    let rx = Math.abs(width / 2);\n    let ry = Math.abs(height / 2);\n    rx += _offsetOpt(rx * 0.01, o);\n    ry += _offsetOpt(ry * 0.01, o);\n    let strt = start;\n    let stp = stop;\n    while (strt < 0) {\n        strt += Math.PI * 2;\n        stp += Math.PI * 2;\n    }\n    if ((stp - strt) > (Math.PI * 2)) {\n        strt = 0;\n        stp = Math.PI * 2;\n    }\n    const ellipseInc = (Math.PI * 2) / o.curveStepCount;\n    const arcInc = Math.min(ellipseInc / 2, (stp - strt) / 2);\n    const ops = _arc(arcInc, cx, cy, rx, ry, strt, stp, 1, o);\n    if (!o.disableMultiStroke) {\n        const o2 = _arc(arcInc, cx, cy, rx, ry, strt, stp, 1.5, o);\n        ops.push(...o2);\n    }\n    if (closed) {\n        if (roughClosure) {\n            ops.push(..._doubleLine(cx, cy, cx + rx * Math.cos(strt), cy + ry * Math.sin(strt), o), ..._doubleLine(cx, cy, cx + rx * Math.cos(stp), cy + ry * Math.sin(stp), o));\n        }\n        else {\n            ops.push({ op: 'lineTo', data: [cx, cy] }, { op: 'lineTo', data: [cx + rx * Math.cos(strt), cy + ry * Math.sin(strt)] });\n        }\n    }\n    return { type: 'path', ops };\n}\nexport function svgPath(path, o) {\n    const segments = normalize(absolutize(parsePath(path)));\n    const ops = [];\n    let first = [0, 0];\n    let current = [0, 0];\n    for (const { key, data } of segments) {\n        switch (key) {\n            case 'M': {\n                const ro = 1 * (o.maxRandomnessOffset || 0);\n                const pv = o.preserveVertices;\n                ops.push({ op: 'move', data: data.map((d) => d + (pv ? 0 : _offsetOpt(ro, o))) });\n                current = [data[0], data[1]];\n                first = [data[0], data[1]];\n                break;\n            }\n            case 'L':\n                ops.push(..._doubleLine(current[0], current[1], data[0], data[1], o));\n                current = [data[0], data[1]];\n                break;\n            case 'C': {\n                const [x1, y1, x2, y2, x, y] = data;\n                ops.push(..._bezierTo(x1, y1, x2, y2, x, y, current, o));\n                current = [x, y];\n                break;\n            }\n            case 'Z':\n                ops.push(..._doubleLine(current[0], current[1], first[0], first[1], o));\n                current = [first[0], first[1]];\n                break;\n        }\n    }\n    return { type: 'path', ops };\n}\n// Fills\nexport function solidFillPolygon(polygonList, o) {\n    const ops = [];\n    for (const points of polygonList) {\n        if (points.length) {\n            const offset = o.maxRandomnessOffset || 0;\n            const len = points.length;\n            if (len > 2) {\n                ops.push({ op: 'move', data: [points[0][0] + _offsetOpt(offset, o), points[0][1] + _offsetOpt(offset, o)] });\n                for (let i = 1; i < len; i++) {\n                    ops.push({ op: 'lineTo', data: [points[i][0] + _offsetOpt(offset, o), points[i][1] + _offsetOpt(offset, o)] });\n                }\n            }\n        }\n    }\n    return { type: 'fillPath', ops };\n}\nexport function patternFillPolygons(polygonList, o) {\n    return getFiller(o, helper).fillPolygons(polygonList, o);\n}\nexport function patternFillArc(x, y, width, height, start, stop, o) {\n    const cx = x;\n    const cy = y;\n    let rx = Math.abs(width / 2);\n    let ry = Math.abs(height / 2);\n    rx += _offsetOpt(rx * 0.01, o);\n    ry += _offsetOpt(ry * 0.01, o);\n    let strt = start;\n    let stp = stop;\n    while (strt < 0) {\n        strt += Math.PI * 2;\n        stp += Math.PI * 2;\n    }\n    if ((stp - strt) > (Math.PI * 2)) {\n        strt = 0;\n        stp = Math.PI * 2;\n    }\n    const increment = (stp - strt) / o.curveStepCount;\n    const points = [];\n    for (let angle = strt; angle <= stp; angle = angle + increment) {\n        points.push([cx + rx * Math.cos(angle), cy + ry * Math.sin(angle)]);\n    }\n    points.push([cx + rx * Math.cos(stp), cy + ry * Math.sin(stp)]);\n    points.push([cx, cy]);\n    return patternFillPolygons([points], o);\n}\nexport function randOffset(x, o) {\n    return _offsetOpt(x, o);\n}\nexport function randOffsetWithRange(min, max, o) {\n    return _offset(min, max, o);\n}\nexport function doubleLineFillOps(x1, y1, x2, y2, o) {\n    return _doubleLine(x1, y1, x2, y2, o, true);\n}\n// Private helpers\nfunction cloneOptionsAlterSeed(ops) {\n    const result = Object.assign({}, ops);\n    result.randomizer = undefined;\n    if (ops.seed) {\n        result.seed = ops.seed + 1;\n    }\n    return result;\n}\nfunction random(ops) {\n    if (!ops.randomizer) {\n        ops.randomizer = new Random(ops.seed || 0);\n    }\n    return ops.randomizer.next();\n}\nfunction _offset(min, max, ops, roughnessGain = 1) {\n    return ops.roughness * roughnessGain * ((random(ops) * (max - min)) + min);\n}\nfunction _offsetOpt(x, ops, roughnessGain = 1) {\n    return _offset(-x, x, ops, roughnessGain);\n}\nfunction _doubleLine(x1, y1, x2, y2, o, filling = false) {\n    const singleStroke = filling ? o.disableMultiStrokeFill : o.disableMultiStroke;\n    const o1 = _line(x1, y1, x2, y2, o, true, false);\n    if (singleStroke) {\n        return o1;\n    }\n    const o2 = _line(x1, y1, x2, y2, o, true, true);\n    return o1.concat(o2);\n}\nfunction _line(x1, y1, x2, y2, o, move, overlay) {\n    const lengthSq = Math.pow((x1 - x2), 2) + Math.pow((y1 - y2), 2);\n    const length = Math.sqrt(lengthSq);\n    let roughnessGain = 1;\n    if (length < 200) {\n        roughnessGain = 1;\n    }\n    else if (length > 500) {\n        roughnessGain = 0.4;\n    }\n    else {\n        roughnessGain = (-0.0016668) * length + 1.233334;\n    }\n    let offset = o.maxRandomnessOffset || 0;\n    if ((offset * offset * 100) > lengthSq) {\n        offset = length / 10;\n    }\n    const halfOffset = offset / 2;\n    const divergePoint = 0.2 + random(o) * 0.2;\n    let midDispX = o.bowing * o.maxRandomnessOffset * (y2 - y1) / 200;\n    let midDispY = o.bowing * o.maxRandomnessOffset * (x1 - x2) / 200;\n    midDispX = _offsetOpt(midDispX, o, roughnessGain);\n    midDispY = _offsetOpt(midDispY, o, roughnessGain);\n    const ops = [];\n    const randomHalf = () => _offsetOpt(halfOffset, o, roughnessGain);\n    const randomFull = () => _offsetOpt(offset, o, roughnessGain);\n    const preserveVertices = o.preserveVertices;\n    if (move) {\n        if (overlay) {\n            ops.push({\n                op: 'move', data: [\n                    x1 + (preserveVertices ? 0 : randomHalf()),\n                    y1 + (preserveVertices ? 0 : randomHalf()),\n                ],\n            });\n        }\n        else {\n            ops.push({\n                op: 'move', data: [\n                    x1 + (preserveVertices ? 0 : _offsetOpt(offset, o, roughnessGain)),\n                    y1 + (preserveVertices ? 0 : _offsetOpt(offset, o, roughnessGain)),\n                ],\n            });\n        }\n    }\n    if (overlay) {\n        ops.push({\n            op: 'bcurveTo',\n            data: [\n                midDispX + x1 + (x2 - x1) * divergePoint + randomHalf(),\n                midDispY + y1 + (y2 - y1) * divergePoint + randomHalf(),\n                midDispX + x1 + 2 * (x2 - x1) * divergePoint + randomHalf(),\n                midDispY + y1 + 2 * (y2 - y1) * divergePoint + randomHalf(),\n                x2 + (preserveVertices ? 0 : randomHalf()),\n                y2 + (preserveVertices ? 0 : randomHalf()),\n            ],\n        });\n    }\n    else {\n        ops.push({\n            op: 'bcurveTo',\n            data: [\n                midDispX + x1 + (x2 - x1) * divergePoint + randomFull(),\n                midDispY + y1 + (y2 - y1) * divergePoint + randomFull(),\n                midDispX + x1 + 2 * (x2 - x1) * divergePoint + randomFull(),\n                midDispY + y1 + 2 * (y2 - y1) * divergePoint + randomFull(),\n                x2 + (preserveVertices ? 0 : randomFull()),\n                y2 + (preserveVertices ? 0 : randomFull()),\n            ],\n        });\n    }\n    return ops;\n}\nfunction _curveWithOffset(points, offset, o) {\n    const ps = [];\n    ps.push([\n        points[0][0] + _offsetOpt(offset, o),\n        points[0][1] + _offsetOpt(offset, o),\n    ]);\n    ps.push([\n        points[0][0] + _offsetOpt(offset, o),\n        points[0][1] + _offsetOpt(offset, o),\n    ]);\n    for (let i = 1; i < points.length; i++) {\n        ps.push([\n            points[i][0] + _offsetOpt(offset, o),\n            points[i][1] + _offsetOpt(offset, o),\n        ]);\n        if (i === (points.length - 1)) {\n            ps.push([\n                points[i][0] + _offsetOpt(offset, o),\n                points[i][1] + _offsetOpt(offset, o),\n            ]);\n        }\n    }\n    return _curve(ps, null, o);\n}\nfunction _curve(points, closePoint, o) {\n    const len = points.length;\n    const ops = [];\n    if (len > 3) {\n        const b = [];\n        const s = 1 - o.curveTightness;\n        ops.push({ op: 'move', data: [points[1][0], points[1][1]] });\n        for (let i = 1; (i + 2) < len; i++) {\n            const cachedVertArray = points[i];\n            b[0] = [cachedVertArray[0], cachedVertArray[1]];\n            b[1] = [cachedVertArray[0] + (s * points[i + 1][0] - s * points[i - 1][0]) / 6, cachedVertArray[1] + (s * points[i + 1][1] - s * points[i - 1][1]) / 6];\n            b[2] = [points[i + 1][0] + (s * points[i][0] - s * points[i + 2][0]) / 6, points[i + 1][1] + (s * points[i][1] - s * points[i + 2][1]) / 6];\n            b[3] = [points[i + 1][0], points[i + 1][1]];\n            ops.push({ op: 'bcurveTo', data: [b[1][0], b[1][1], b[2][0], b[2][1], b[3][0], b[3][1]] });\n        }\n        if (closePoint && closePoint.length === 2) {\n            const ro = o.maxRandomnessOffset;\n            ops.push({ op: 'lineTo', data: [closePoint[0] + _offsetOpt(ro, o), closePoint[1] + _offsetOpt(ro, o)] });\n        }\n    }\n    else if (len === 3) {\n        ops.push({ op: 'move', data: [points[1][0], points[1][1]] });\n        ops.push({\n            op: 'bcurveTo',\n            data: [\n                points[1][0], points[1][1],\n                points[2][0], points[2][1],\n                points[2][0], points[2][1],\n            ],\n        });\n    }\n    else if (len === 2) {\n        ops.push(..._doubleLine(points[0][0], points[0][1], points[1][0], points[1][1], o));\n    }\n    return ops;\n}\nfunction _computeEllipsePoints(increment, cx, cy, rx, ry, offset, overlap, o) {\n    const coreOnly = o.roughness === 0;\n    const corePoints = [];\n    const allPoints = [];\n    if (coreOnly) {\n        increment = increment / 4;\n        allPoints.push([\n            cx + rx * Math.cos(-increment),\n            cy + ry * Math.sin(-increment),\n        ]);\n        for (let angle = 0; angle <= Math.PI * 2; angle = angle + increment) {\n            const p = [\n                cx + rx * Math.cos(angle),\n                cy + ry * Math.sin(angle),\n            ];\n            corePoints.push(p);\n            allPoints.push(p);\n        }\n        allPoints.push([\n            cx + rx * Math.cos(0),\n            cy + ry * Math.sin(0),\n        ]);\n        allPoints.push([\n            cx + rx * Math.cos(increment),\n            cy + ry * Math.sin(increment),\n        ]);\n    }\n    else {\n        const radOffset = _offsetOpt(0.5, o) - (Math.PI / 2);\n        allPoints.push([\n            _offsetOpt(offset, o) + cx + 0.9 * rx * Math.cos(radOffset - increment),\n            _offsetOpt(offset, o) + cy + 0.9 * ry * Math.sin(radOffset - increment),\n        ]);\n        const endAngle = Math.PI * 2 + radOffset - 0.01;\n        for (let angle = radOffset; angle < endAngle; angle = angle + increment) {\n            const p = [\n                _offsetOpt(offset, o) + cx + rx * Math.cos(angle),\n                _offsetOpt(offset, o) + cy + ry * Math.sin(angle),\n            ];\n            corePoints.push(p);\n            allPoints.push(p);\n        }\n        allPoints.push([\n            _offsetOpt(offset, o) + cx + rx * Math.cos(radOffset + Math.PI * 2 + overlap * 0.5),\n            _offsetOpt(offset, o) + cy + ry * Math.sin(radOffset + Math.PI * 2 + overlap * 0.5),\n        ]);\n        allPoints.push([\n            _offsetOpt(offset, o) + cx + 0.98 * rx * Math.cos(radOffset + overlap),\n            _offsetOpt(offset, o) + cy + 0.98 * ry * Math.sin(radOffset + overlap),\n        ]);\n        allPoints.push([\n            _offsetOpt(offset, o) + cx + 0.9 * rx * Math.cos(radOffset + overlap * 0.5),\n            _offsetOpt(offset, o) + cy + 0.9 * ry * Math.sin(radOffset + overlap * 0.5),\n        ]);\n    }\n    return [allPoints, corePoints];\n}\nfunction _arc(increment, cx, cy, rx, ry, strt, stp, offset, o) {\n    const radOffset = strt + _offsetOpt(0.1, o);\n    const points = [];\n    points.push([\n        _offsetOpt(offset, o) + cx + 0.9 * rx * Math.cos(radOffset - increment),\n        _offsetOpt(offset, o) + cy + 0.9 * ry * Math.sin(radOffset - increment),\n    ]);\n    for (let angle = radOffset; angle <= stp; angle = angle + increment) {\n        points.push([\n            _offsetOpt(offset, o) + cx + rx * Math.cos(angle),\n            _offsetOpt(offset, o) + cy + ry * Math.sin(angle),\n        ]);\n    }\n    points.push([\n        cx + rx * Math.cos(stp),\n        cy + ry * Math.sin(stp),\n    ]);\n    points.push([\n        cx + rx * Math.cos(stp),\n        cy + ry * Math.sin(stp),\n    ]);\n    return _curve(points, null, o);\n}\nfunction _bezierTo(x1, y1, x2, y2, x, y, current, o) {\n    const ops = [];\n    const ros = [o.maxRandomnessOffset || 1, (o.maxRandomnessOffset || 1) + 0.3];\n    let f = [0, 0];\n    const iterations = o.disableMultiStroke ? 1 : 2;\n    const preserveVertices = o.preserveVertices;\n    for (let i = 0; i < iterations; i++) {\n        if (i === 0) {\n            ops.push({ op: 'move', data: [current[0], current[1]] });\n        }\n        else {\n            ops.push({ op: 'move', data: [current[0] + (preserveVertices ? 0 : _offsetOpt(ros[0], o)), current[1] + (preserveVertices ? 0 : _offsetOpt(ros[0], o))] });\n        }\n        f = preserveVertices ? [x, y] : [x + _offsetOpt(ros[i], o), y + _offsetOpt(ros[i], o)];\n        ops.push({\n            op: 'bcurveTo',\n            data: [\n                x1 + _offsetOpt(ros[i], o), y1 + _offsetOpt(ros[i], o),\n                x2 + _offsetOpt(ros[i], o), y2 + _offsetOpt(ros[i], o),\n                f[0], f[1],\n            ],\n        });\n    }\n    return ops;\n}\n","function clone(p) {\n    return [...p];\n}\nexport function curveToBezier(pointsIn, curveTightness = 0) {\n    const len = pointsIn.length;\n    if (len < 3) {\n        throw new Error('A curve must have at least three points.');\n    }\n    const out = [];\n    if (len === 3) {\n        out.push(clone(pointsIn[0]), clone(pointsIn[1]), clone(pointsIn[2]), clone(pointsIn[2]));\n    }\n    else {\n        const points = [];\n        points.push(pointsIn[0], pointsIn[0]);\n        for (let i = 1; i < pointsIn.length; i++) {\n            points.push(pointsIn[i]);\n            if (i === (pointsIn.length - 1)) {\n                points.push(pointsIn[i]);\n            }\n        }\n        const b = [];\n        const s = 1 - curveTightness;\n        out.push(clone(points[0]));\n        for (let i = 1; (i + 2) < points.length; i++) {\n            const cachedVertArray = points[i];\n            b[0] = [cachedVertArray[0], cachedVertArray[1]];\n            b[1] = [cachedVertArray[0] + (s * points[i + 1][0] - s * points[i - 1][0]) / 6, cachedVertArray[1] + (s * points[i + 1][1] - s * points[i - 1][1]) / 6];\n            b[2] = [points[i + 1][0] + (s * points[i][0] - s * points[i + 2][0]) / 6, points[i + 1][1] + (s * points[i][1] - s * points[i + 2][1]) / 6];\n            b[3] = [points[i + 1][0], points[i + 1][1]];\n            out.push(b[1], b[2], b[3]);\n        }\n    }\n    return out;\n}\n","// distance between 2 points\nfunction distance(p1, p2) {\n    return Math.sqrt(distanceSq(p1, p2));\n}\n// distance between 2 points squared\nfunction distanceSq(p1, p2) {\n    return Math.pow(p1[0] - p2[0], 2) + Math.pow(p1[1] - p2[1], 2);\n}\n// Sistance squared from a point p to the line segment vw\nfunction distanceToSegmentSq(p, v, w) {\n    const l2 = distanceSq(v, w);\n    if (l2 === 0) {\n        return distanceSq(p, v);\n    }\n    let t = ((p[0] - v[0]) * (w[0] - v[0]) + (p[1] - v[1]) * (w[1] - v[1])) / l2;\n    t = Math.max(0, Math.min(1, t));\n    return distanceSq(p, lerp(v, w, t));\n}\nfunction lerp(a, b, t) {\n    return [\n        a[0] + (b[0] - a[0]) * t,\n        a[1] + (b[1] - a[1]) * t,\n    ];\n}\n// Adapted from https://seant23.wordpress.com/2010/11/12/offset-bezier-curves/\nfunction flatness(points, offset) {\n    const p1 = points[offset + 0];\n    const p2 = points[offset + 1];\n    const p3 = points[offset + 2];\n    const p4 = points[offset + 3];\n    let ux = 3 * p2[0] - 2 * p1[0] - p4[0];\n    ux *= ux;\n    let uy = 3 * p2[1] - 2 * p1[1] - p4[1];\n    uy *= uy;\n    let vx = 3 * p3[0] - 2 * p4[0] - p1[0];\n    vx *= vx;\n    let vy = 3 * p3[1] - 2 * p4[1] - p1[1];\n    vy *= vy;\n    if (ux < vx) {\n        ux = vx;\n    }\n    if (uy < vy) {\n        uy = vy;\n    }\n    return ux + uy;\n}\nfunction getPointsOnBezierCurveWithSplitting(points, offset, tolerance, newPoints) {\n    const outPoints = newPoints || [];\n    if (flatness(points, offset) < tolerance) {\n        const p0 = points[offset + 0];\n        if (outPoints.length) {\n            const d = distance(outPoints[outPoints.length - 1], p0);\n            if (d > 1) {\n                outPoints.push(p0);\n            }\n        }\n        else {\n            outPoints.push(p0);\n        }\n        outPoints.push(points[offset + 3]);\n    }\n    else {\n        // subdivide\n        const t = .5;\n        const p1 = points[offset + 0];\n        const p2 = points[offset + 1];\n        const p3 = points[offset + 2];\n        const p4 = points[offset + 3];\n        const q1 = lerp(p1, p2, t);\n        const q2 = lerp(p2, p3, t);\n        const q3 = lerp(p3, p4, t);\n        const r1 = lerp(q1, q2, t);\n        const r2 = lerp(q2, q3, t);\n        const red = lerp(r1, r2, t);\n        getPointsOnBezierCurveWithSplitting([p1, q1, r1, red], 0, tolerance, outPoints);\n        getPointsOnBezierCurveWithSplitting([red, r2, q3, p4], 0, tolerance, outPoints);\n    }\n    return outPoints;\n}\nexport function simplify(points, distance) {\n    return simplifyPoints(points, 0, points.length, distance);\n}\n// RamerDouglasPeucker algorithm\n// https://en.wikipedia.org/wiki/Ramer%E2%80%93Douglas%E2%80%93Peucker_algorithm\nfunction simplifyPoints(points, start, end, epsilon, newPoints) {\n    const outPoints = newPoints || [];\n    // find the most distance point from the endpoints\n    const s = points[start];\n    const e = points[end - 1];\n    let maxDistSq = 0;\n    let maxNdx = 1;\n    for (let i = start + 1; i < end - 1; ++i) {\n        const distSq = distanceToSegmentSq(points[i], s, e);\n        if (distSq > maxDistSq) {\n            maxDistSq = distSq;\n            maxNdx = i;\n        }\n    }\n    // if that point is too far, split\n    if (Math.sqrt(maxDistSq) > epsilon) {\n        simplifyPoints(points, start, maxNdx + 1, epsilon, outPoints);\n        simplifyPoints(points, maxNdx, end, epsilon, outPoints);\n    }\n    else {\n        if (!outPoints.length) {\n            outPoints.push(s);\n        }\n        outPoints.push(e);\n    }\n    return outPoints;\n}\nexport function pointsOnBezierCurves(points, tolerance = 0.15, distance) {\n    const newPoints = [];\n    const numSegments = (points.length - 1) / 3;\n    for (let i = 0; i < numSegments; i++) {\n        const offset = i * 3;\n        getPointsOnBezierCurveWithSplitting(points, offset, tolerance, newPoints);\n    }\n    if (distance && distance > 0) {\n        return simplifyPoints(newPoints, 0, newPoints.length, distance);\n    }\n    return newPoints;\n}\n","import { line, solidFillPolygon, patternFillPolygons, rectangle, ellipseWithParams, generateEllipseParams, linearPath, arc, patternFillArc, curve, svgPath } from './renderer.js';\nimport { randomSeed } from './math.js';\nimport { curveToBezier } from 'points-on-curve/lib/curve-to-bezier.js';\nimport { pointsOnBezierCurves } from 'points-on-curve';\nimport { pointsOnPath } from 'points-on-path';\nconst NOS = 'none';\nexport class RoughGenerator {\n    constructor(config) {\n        this.defaultOptions = {\n            maxRandomnessOffset: 2,\n            roughness: 1,\n            bowing: 1,\n            stroke: '#000',\n            strokeWidth: 1,\n            curveTightness: 0,\n            curveFitting: 0.95,\n            curveStepCount: 9,\n            fillStyle: 'hachure',\n            fillWeight: -1,\n            hachureAngle: -41,\n            hachureGap: -1,\n            dashOffset: -1,\n            dashGap: -1,\n            zigzagOffset: -1,\n            seed: 0,\n            disableMultiStroke: false,\n            disableMultiStrokeFill: false,\n            preserveVertices: false,\n        };\n        this.config = config || {};\n        if (this.config.options) {\n            this.defaultOptions = this._o(this.config.options);\n        }\n    }\n    static newSeed() {\n        return randomSeed();\n    }\n    _o(options) {\n        return options ? Object.assign({}, this.defaultOptions, options) : this.defaultOptions;\n    }\n    _d(shape, sets, options) {\n        return { shape, sets: sets || [], options: options || this.defaultOptions };\n    }\n    line(x1, y1, x2, y2, options) {\n        const o = this._o(options);\n        return this._d('line', [line(x1, y1, x2, y2, o)], o);\n    }\n    rectangle(x, y, width, height, options) {\n        const o = this._o(options);\n        const paths = [];\n        const outline = rectangle(x, y, width, height, o);\n        if (o.fill) {\n            const points = [[x, y], [x + width, y], [x + width, y + height], [x, y + height]];\n            if (o.fillStyle === 'solid') {\n                paths.push(solidFillPolygon([points], o));\n            }\n            else {\n                paths.push(patternFillPolygons([points], o));\n            }\n        }\n        if (o.stroke !== NOS) {\n            paths.push(outline);\n        }\n        return this._d('rectangle', paths, o);\n    }\n    ellipse(x, y, width, height, options) {\n        const o = this._o(options);\n        const paths = [];\n        const ellipseParams = generateEllipseParams(width, height, o);\n        const ellipseResponse = ellipseWithParams(x, y, o, ellipseParams);\n        if (o.fill) {\n            if (o.fillStyle === 'solid') {\n                const shape = ellipseWithParams(x, y, o, ellipseParams).opset;\n                shape.type = 'fillPath';\n                paths.push(shape);\n            }\n            else {\n                paths.push(patternFillPolygons([ellipseResponse.estimatedPoints], o));\n            }\n        }\n        if (o.stroke !== NOS) {\n            paths.push(ellipseResponse.opset);\n        }\n        return this._d('ellipse', paths, o);\n    }\n    circle(x, y, diameter, options) {\n        const ret = this.ellipse(x, y, diameter, diameter, options);\n        ret.shape = 'circle';\n        return ret;\n    }\n    linearPath(points, options) {\n        const o = this._o(options);\n        return this._d('linearPath', [linearPath(points, false, o)], o);\n    }\n    arc(x, y, width, height, start, stop, closed = false, options) {\n        const o = this._o(options);\n        const paths = [];\n        const outline = arc(x, y, width, height, start, stop, closed, true, o);\n        if (closed && o.fill) {\n            if (o.fillStyle === 'solid') {\n                const fillOptions = Object.assign({}, o);\n                fillOptions.disableMultiStroke = true;\n                const shape = arc(x, y, width, height, start, stop, true, false, fillOptions);\n                shape.type = 'fillPath';\n                paths.push(shape);\n            }\n            else {\n                paths.push(patternFillArc(x, y, width, height, start, stop, o));\n            }\n        }\n        if (o.stroke !== NOS) {\n            paths.push(outline);\n        }\n        return this._d('arc', paths, o);\n    }\n    curve(points, options) {\n        const o = this._o(options);\n        const paths = [];\n        const outline = curve(points, o);\n        if (o.fill && o.fill !== NOS && points.length >= 3) {\n            const bcurve = curveToBezier(points);\n            const polyPoints = pointsOnBezierCurves(bcurve, 10, (1 + o.roughness) / 2);\n            if (o.fillStyle === 'solid') {\n                paths.push(solidFillPolygon([polyPoints], o));\n            }\n            else {\n                paths.push(patternFillPolygons([polyPoints], o));\n            }\n        }\n        if (o.stroke !== NOS) {\n            paths.push(outline);\n        }\n        return this._d('curve', paths, o);\n    }\n    polygon(points, options) {\n        const o = this._o(options);\n        const paths = [];\n        const outline = linearPath(points, true, o);\n        if (o.fill) {\n            if (o.fillStyle === 'solid') {\n                paths.push(solidFillPolygon([points], o));\n            }\n            else {\n                paths.push(patternFillPolygons([points], o));\n            }\n        }\n        if (o.stroke !== NOS) {\n            paths.push(outline);\n        }\n        return this._d('polygon', paths, o);\n    }\n    path(d, options) {\n        const o = this._o(options);\n        const paths = [];\n        if (!d) {\n            return this._d('path', paths, o);\n        }\n        d = (d || '').replace(/\\n/g, ' ').replace(/(-\\s)/g, '-').replace('/(\\s\\s)/g', ' ');\n        const hasFill = o.fill && o.fill !== 'transparent' && o.fill !== NOS;\n        const hasStroke = o.stroke !== NOS;\n        const simplified = !!(o.simplification && (o.simplification < 1));\n        const distance = simplified ? (4 - 4 * (o.simplification)) : ((1 + o.roughness) / 2);\n        const sets = pointsOnPath(d, 1, distance);\n        if (hasFill) {\n            if (o.fillStyle === 'solid') {\n                paths.push(solidFillPolygon(sets, o));\n            }\n            else {\n                paths.push(patternFillPolygons(sets, o));\n            }\n        }\n        if (hasStroke) {\n            if (simplified) {\n                sets.forEach((set) => {\n                    paths.push(linearPath(set, false, o));\n                });\n            }\n            else {\n                paths.push(svgPath(d, o));\n            }\n        }\n        return this._d('path', paths, o);\n    }\n    opsToPath(drawing, fixedDecimals) {\n        let path = '';\n        for (const item of drawing.ops) {\n            const data = ((typeof fixedDecimals === 'number') && fixedDecimals >= 0) ? (item.data.map((d) => +d.toFixed(fixedDecimals))) : item.data;\n            switch (item.op) {\n                case 'move':\n                    path += `M${data[0]} ${data[1]} `;\n                    break;\n                case 'bcurveTo':\n                    path += `C${data[0]} ${data[1]}, ${data[2]} ${data[3]}, ${data[4]} ${data[5]} `;\n                    break;\n                case 'lineTo':\n                    path += `L${data[0]} ${data[1]} `;\n                    break;\n            }\n        }\n        return path.trim();\n    }\n    toPaths(drawable) {\n        const sets = drawable.sets || [];\n        const o = drawable.options || this.defaultOptions;\n        const paths = [];\n        for (const drawing of sets) {\n            let path = null;\n            switch (drawing.type) {\n                case 'path':\n                    path = {\n                        d: this.opsToPath(drawing),\n                        stroke: o.stroke,\n                        strokeWidth: o.strokeWidth,\n                        fill: NOS,\n                    };\n                    break;\n                case 'fillPath':\n                    path = {\n                        d: this.opsToPath(drawing),\n                        stroke: NOS,\n                        strokeWidth: 0,\n                        fill: o.fill || NOS,\n                    };\n                    break;\n                case 'fillSketch':\n                    path = this.fillSketch(drawing, o);\n                    break;\n            }\n            if (path) {\n                paths.push(path);\n            }\n        }\n        return paths;\n    }\n    fillSketch(drawing, o) {\n        let fweight = o.fillWeight;\n        if (fweight < 0) {\n            fweight = o.strokeWidth / 2;\n        }\n        return {\n            d: this.opsToPath(drawing),\n            stroke: o.fill || NOS,\n            strokeWidth: fweight,\n            fill: NOS,\n        };\n    }\n}\n","import { pointsOnBezierCurves, simplify } from 'points-on-curve';\nimport { parsePath, absolutize, normalize } from 'path-data-parser';\nexport function pointsOnPath(path, tolerance, distance) {\n    const segments = parsePath(path);\n    const normalized = normalize(absolutize(segments));\n    const sets = [];\n    let currentPoints = [];\n    let start = [0, 0];\n    let pendingCurve = [];\n    const appendPendingCurve = () => {\n        if (pendingCurve.length >= 4) {\n            currentPoints.push(...pointsOnBezierCurves(pendingCurve, tolerance));\n        }\n        pendingCurve = [];\n    };\n    const appendPendingPoints = () => {\n        appendPendingCurve();\n        if (currentPoints.length) {\n            sets.push(currentPoints);\n            currentPoints = [];\n        }\n    };\n    for (const { key, data } of normalized) {\n        switch (key) {\n            case 'M':\n                appendPendingPoints();\n                start = [data[0], data[1]];\n                currentPoints.push(start);\n                break;\n            case 'L':\n                appendPendingCurve();\n                currentPoints.push([data[0], data[1]]);\n                break;\n            case 'C':\n                if (!pendingCurve.length) {\n                    const lastPoint = currentPoints.length ? currentPoints[currentPoints.length - 1] : start;\n                    pendingCurve.push([lastPoint[0], lastPoint[1]]);\n                }\n                pendingCurve.push([data[0], data[1]]);\n                pendingCurve.push([data[2], data[3]]);\n                pendingCurve.push([data[4], data[5]]);\n                break;\n            case 'Z':\n                appendPendingCurve();\n                currentPoints.push([start[0], start[1]]);\n                break;\n        }\n    }\n    appendPendingPoints();\n    if (!distance) {\n        return sets;\n    }\n    const out = [];\n    for (const set of sets) {\n        const simplifiedSet = simplify(set, distance);\n        if (simplifiedSet.length) {\n            out.push(simplifiedSet);\n        }\n    }\n    return out;\n}\n","import { RoughGenerator } from './generator';\nexport class RoughCanvas {\n    constructor(canvas, config) {\n        this.canvas = canvas;\n        this.ctx = this.canvas.getContext('2d');\n        this.gen = new RoughGenerator(config);\n    }\n    draw(drawable) {\n        const sets = drawable.sets || [];\n        const o = drawable.options || this.getDefaultOptions();\n        const ctx = this.ctx;\n        const precision = drawable.options.fixedDecimalPlaceDigits;\n        for (const drawing of sets) {\n            switch (drawing.type) {\n                case 'path':\n                    ctx.save();\n                    ctx.strokeStyle = o.stroke === 'none' ? 'transparent' : o.stroke;\n                    ctx.lineWidth = o.strokeWidth;\n                    if (o.strokeLineDash) {\n                        ctx.setLineDash(o.strokeLineDash);\n                    }\n                    if (o.strokeLineDashOffset) {\n                        ctx.lineDashOffset = o.strokeLineDashOffset;\n                    }\n                    this._drawToContext(ctx, drawing, precision);\n                    ctx.restore();\n                    break;\n                case 'fillPath': {\n                    ctx.save();\n                    ctx.fillStyle = o.fill || '';\n                    const fillRule = (drawable.shape === 'curve' || drawable.shape === 'polygon' || drawable.shape === 'path') ? 'evenodd' : 'nonzero';\n                    this._drawToContext(ctx, drawing, precision, fillRule);\n                    ctx.restore();\n                    break;\n                }\n                case 'fillSketch':\n                    this.fillSketch(ctx, drawing, o);\n                    break;\n            }\n        }\n    }\n    fillSketch(ctx, drawing, o) {\n        let fweight = o.fillWeight;\n        if (fweight < 0) {\n            fweight = o.strokeWidth / 2;\n        }\n        ctx.save();\n        if (o.fillLineDash) {\n            ctx.setLineDash(o.fillLineDash);\n        }\n        if (o.fillLineDashOffset) {\n            ctx.lineDashOffset = o.fillLineDashOffset;\n        }\n        ctx.strokeStyle = o.fill || '';\n        ctx.lineWidth = fweight;\n        this._drawToContext(ctx, drawing, o.fixedDecimalPlaceDigits);\n        ctx.restore();\n    }\n    _drawToContext(ctx, drawing, fixedDecimals, rule = 'nonzero') {\n        ctx.beginPath();\n        for (const item of drawing.ops) {\n            const data = ((typeof fixedDecimals === 'number') && fixedDecimals >= 0) ? (item.data.map((d) => +d.toFixed(fixedDecimals))) : item.data;\n            switch (item.op) {\n                case 'move':\n                    ctx.moveTo(data[0], data[1]);\n                    break;\n                case 'bcurveTo':\n                    ctx.bezierCurveTo(data[0], data[1], data[2], data[3], data[4], data[5]);\n                    break;\n                case 'lineTo':\n                    ctx.lineTo(data[0], data[1]);\n                    break;\n            }\n        }\n        if (drawing.type === 'fillPath') {\n            ctx.fill(rule);\n        }\n        else {\n            ctx.stroke();\n        }\n    }\n    get generator() {\n        return this.gen;\n    }\n    getDefaultOptions() {\n        return this.gen.defaultOptions;\n    }\n    line(x1, y1, x2, y2, options) {\n        const d = this.gen.line(x1, y1, x2, y2, options);\n        this.draw(d);\n        return d;\n    }\n    rectangle(x, y, width, height, options) {\n        const d = this.gen.rectangle(x, y, width, height, options);\n        this.draw(d);\n        return d;\n    }\n    ellipse(x, y, width, height, options) {\n        const d = this.gen.ellipse(x, y, width, height, options);\n        this.draw(d);\n        return d;\n    }\n    circle(x, y, diameter, options) {\n        const d = this.gen.circle(x, y, diameter, options);\n        this.draw(d);\n        return d;\n    }\n    linearPath(points, options) {\n        const d = this.gen.linearPath(points, options);\n        this.draw(d);\n        return d;\n    }\n    polygon(points, options) {\n        const d = this.gen.polygon(points, options);\n        this.draw(d);\n        return d;\n    }\n    arc(x, y, width, height, start, stop, closed = false, options) {\n        const d = this.gen.arc(x, y, width, height, start, stop, closed, options);\n        this.draw(d);\n        return d;\n    }\n    curve(points, options) {\n        const d = this.gen.curve(points, options);\n        this.draw(d);\n        return d;\n    }\n    path(d, options) {\n        const drawing = this.gen.path(d, options);\n        this.draw(drawing);\n        return drawing;\n    }\n}\n","export function getTypedArray(dataview: any, metadata: any) {\n  switch (metadata.dtype) {\n    case 'int8':\n      return new Int8Array(dataview.buffer);\n      break;\n    case 'uint8':\n      return new Uint8Array(dataview.buffer);\n      break;\n    case 'int16':\n      return new Int16Array(dataview.buffer);\n      break;\n    case 'uint16':\n      return new Uint16Array(dataview.buffer);\n      break;\n    case 'int32':\n      return new Int32Array(dataview.buffer);\n      break;\n    case 'uint32':\n      return new Uint32Array(dataview.buffer);\n      break;\n    case 'float32':\n      return new Float32Array(dataview.buffer);\n      break;\n    case 'float64':\n      return new Float64Array(dataview.buffer);\n      break;\n    default:\n      throw 'Unknown dtype ' + metadata.dtype;\n      break;\n  }\n}\n\n// Scalar type\ntype Scalar = null | boolean | number | string;\n\nnamespace Scalar {\n  export function isScalar(x: any): x is Scalar {\n    return (\n      x === null ||\n      typeof x === 'boolean' ||\n      typeof x === 'number' ||\n      typeof x === 'string'\n    );\n  }\n}\n\ntype TypedArray =\n  | Int8Array\n  | Uint8Array\n  | Int16Array\n  | Uint16Array\n  | Int32Array\n  | Uint32Array\n  | Uint8ClampedArray\n  | Float32Array\n  | Float64Array;\n\n// Buffered argument\nexport abstract class Arg {\n  abstract getItem(idx: number): any;\n\n  length: number;\n}\n\nclass ScalarArg extends Arg {\n  constructor(value: Scalar) {\n    super();\n\n    this.value = value;\n    this.length = Infinity;\n  }\n\n  getItem(idx: number): any {\n    return this.value;\n  }\n\n  value: Scalar;\n}\n\nclass BufferArg extends Arg {\n  constructor(bufferMetadata: any, buffer: any[]) {\n    super();\n\n    this.value = getTypedArray(buffer, bufferMetadata);\n    this.length = this.value.length;\n  }\n\n  getItem(idx: number): any {\n    return this.value[idx];\n  }\n\n  value: TypedArray;\n}\n\nexport function getArg(metadata: any, buffers: any): Arg {\n  if (Scalar.isScalar(metadata)) {\n    return new ScalarArg(metadata);\n  }\n\n  if (metadata['idx'] !== undefined) {\n    return new BufferArg(metadata, buffers[metadata['idx']]);\n  }\n\n  throw 'Could not process argument ' + metadata;\n}\n\nexport async function toBlob(canvas: HTMLCanvasElement): Promise<Blob> {\n  return new Promise<Blob>((resolve, reject) => {\n    canvas.toBlob(blob => {\n      if (blob == null) {\n        return reject('Unable to create blob');\n      }\n\n      resolve(blob);\n    });\n  });\n}\n\nexport async function toBytes(\n  canvas: HTMLCanvasElement\n): Promise<Uint8ClampedArray> {\n  const blob = await toBlob(canvas);\n\n  return new Promise<Uint8ClampedArray>((resolve, reject) => {\n    const reader = new FileReader();\n\n    reader.onloadend = () => {\n      if (typeof reader.result == 'string' || reader.result == null) {\n        return reject('Unable to read blob');\n      }\n\n      const bytes = new Uint8ClampedArray(reader.result);\n      resolve(bytes);\n    };\n    reader.readAsArrayBuffer(blob);\n  });\n}\n\nexport async function fromBytes(\n  array: Uint8ClampedArray\n): Promise<HTMLImageElement> {\n  const blob = new Blob([array]);\n\n  return new Promise<HTMLImageElement>((resolve, reject) => {\n    const img = new Image();\n\n    img.onload = () => {\n      resolve(img);\n    };\n\n    img.src = URL.createObjectURL(blob);\n  });\n}\n\nexport async function bufferToImage(buffer: any): Promise<HTMLImageElement> {\n  let url: string;\n\n  const blob = new Blob([buffer], { type: 'image/jpeg' });\n  url = URL.createObjectURL(blob);\n\n  const img = new Image();\n  return new Promise(resolve => {\n    img.onload = () => {\n      resolve(img);\n    };\n    img.src = url;\n  });\n}\n","// Copyright (c) Martin Renou\n// Distributed under the terms of the Modified BSD License.\n\nimport { Buffer } from 'buffer';\n\nimport {\n  DOMWidgetModel,\n  DOMWidgetView,\n  WidgetModel,\n  ISerializers,\n  Dict,\n  unpack_models\n} from '@jupyter-widgets/base';\n\nimport { RoughCanvas } from 'roughjs/bin/canvas';\n\nimport { MODULE_NAME, MODULE_VERSION } from './version';\n\nimport {\n  getArg,\n  toBytes,\n  fromBytes,\n  getTypedArray,\n  bufferToImage\n} from './utils';\n\nfunction getContext(canvas: HTMLCanvasElement) {\n  const context = canvas.getContext('2d');\n  if (context === null) {\n    throw 'Could not create 2d context.';\n  }\n  return context;\n}\n\nfunction serializeImageData(array: Uint8ClampedArray) {\n  return new DataView(array.buffer.slice(0));\n}\n\nfunction deserializeImageData(dataview: DataView | null) {\n  if (dataview === null) {\n    return null;\n  }\n\n  return new Uint8ClampedArray(dataview.buffer);\n}\n\nasync function createImageFromWidget(\n  image: DOMWidgetModel\n): Promise<HTMLImageElement> {\n  // Create the image manually instead of creating an ImageView\n  let url: string;\n  const format = image.get('format');\n  const value = image.get('value');\n  if (format !== 'url') {\n    const blob = new Blob([value], { type: `image/${format}` });\n    url = URL.createObjectURL(blob);\n  } else {\n    url = new TextDecoder('utf-8').decode(value.buffer);\n  }\n\n  const img = new Image();\n  return new Promise(resolve => {\n    img.onload = () => {\n      resolve(img);\n    };\n    img.src = url;\n  });\n}\n\nconst COMMANDS = [\n  'fillRect',\n  'strokeRect',\n  'fillRects',\n  'strokeRects',\n  'clearRect',\n  'fillArc',\n  'fillCircle',\n  'strokeArc',\n  'strokeCircle',\n  'fillArcs',\n  'strokeArcs',\n  'fillCircles',\n  'strokeCircles',\n  'strokeLine',\n  'beginPath',\n  'closePath',\n  'stroke',\n  'fillPath',\n  'fill',\n  'moveTo',\n  'lineTo',\n  'rect',\n  'arc',\n  'ellipse',\n  'arcTo',\n  'quadraticCurveTo',\n  'bezierCurveTo',\n  'fillText',\n  'strokeText',\n  'setLineDash',\n  'drawImage',\n  'putImageData',\n  'clip',\n  'save',\n  'restore',\n  'translate',\n  'rotate',\n  'scale',\n  'transform',\n  'setTransform',\n  'resetTransform',\n  'set',\n  'clear',\n  'sleep',\n  'fillPolygon',\n  'strokePolygon',\n  'strokeLines',\n  'fillPolygons',\n  'strokePolygons',\n  'strokeLineSegments',\n  'fillStyledRects',\n  'strokeStyledRects',\n  'fillStyledCircles',\n  'strokeStyledCircles',\n  'fillStyledArcs',\n  'strokeStyledArcs',\n  'fillStyledPolygons',\n  'strokeStyledPolygons',\n  'strokeStyledLineSegments',\n  'switchCanvas'\n];\n\nexport class CanvasManagerModel extends WidgetModel {\n  defaults() {\n    return {\n      ...super.defaults(),\n      _model_name: CanvasManagerModel.model_name,\n      _model_module: CanvasManagerModel.model_module,\n      _model_module_version: CanvasManagerModel.model_module_version\n    };\n  }\n\n  initialize(attributes: any, options: any) {\n    super.initialize(attributes, options);\n\n    this.on('msg:custom', (command: any, buffers: any) => {\n      this.currentProcessing = this.currentProcessing.then(async () => {\n        await this.onCommand(command, buffers);\n      });\n    });\n  }\n\n  private async onCommand(command: any, buffers: any) {\n    // Retrieve the commands buffer as an object (list of commands)\n    const commands = JSON.parse(\n      Buffer.from(getTypedArray(buffers[0], command)).toString('utf-8')\n    );\n\n    this.canvasesToUpdate =\n      this.currentCanvas !== undefined ? [this.currentCanvas] : [];\n\n    await this.processCommand(commands, buffers.slice(1, buffers.length));\n\n    for (const canvas of this.canvasesToUpdate) {\n      canvas.syncViews();\n    }\n  }\n\n  private async processCommand(command: any, buffers: any) {\n    // If it's a list of commands\n    if (command instanceof Array && command[0] instanceof Array) {\n      let remainingBuffers = buffers;\n\n      for (const subcommand of command) {\n        let subbuffers = [];\n        const nBuffers: Number = subcommand[2];\n        if (nBuffers) {\n          subbuffers = remainingBuffers.slice(0, nBuffers);\n          remainingBuffers = remainingBuffers.slice(nBuffers);\n        }\n        await this.processCommand(subcommand, subbuffers);\n      }\n      return;\n    }\n\n    const name: string = COMMANDS[command[0]];\n    const args: any[] = command[1];\n    switch (name) {\n      case 'switchCanvas':\n        await this.switchCanvas(args[0]);\n        this.canvasesToUpdate.push(this.currentCanvas);\n        break;\n      case 'sleep':\n        await this.currentCanvas.sleep(args[0]);\n        break;\n      case 'fillRect':\n        this.currentCanvas.fillRect(args[0], args[1], args[2], args[3]);\n        break;\n      case 'strokeRect':\n        this.currentCanvas.strokeRect(args[0], args[1], args[2], args[3]);\n        break;\n      case 'fillRects':\n        this.currentCanvas.drawRects(\n          args,\n          buffers,\n          this.currentCanvas.fillRect.bind(this.currentCanvas)\n        );\n        break;\n      case 'strokeRects':\n        this.currentCanvas.drawRects(\n          args,\n          buffers,\n          this.currentCanvas.strokeRect.bind(this.currentCanvas)\n        );\n        break;\n      case 'fillArc':\n        this.currentCanvas.fillArc(\n          args[0],\n          args[1],\n          args[2],\n          args[3],\n          args[4],\n          args[5]\n        );\n        break;\n      case 'strokeArc':\n        this.currentCanvas.strokeArc(\n          args[0],\n          args[1],\n          args[2],\n          args[3],\n          args[4],\n          args[5]\n        );\n        break;\n      case 'fillArcs':\n        this.currentCanvas.drawArcs(\n          args,\n          buffers,\n          this.currentCanvas.fillArc.bind(this.currentCanvas)\n        );\n        break;\n      case 'strokeArcs':\n        this.currentCanvas.drawArcs(\n          args,\n          buffers,\n          this.currentCanvas.strokeArc.bind(this.currentCanvas)\n        );\n        break;\n      case 'fillCircle':\n        this.currentCanvas.fillCircle(args[0], args[1], args[2]);\n        break;\n      case 'strokeCircle':\n        this.currentCanvas.strokeCircle(args[0], args[1], args[2]);\n        break;\n      case 'fillCircles':\n        this.currentCanvas.drawCircles(\n          args,\n          buffers,\n          this.currentCanvas.fillCircle.bind(this.currentCanvas)\n        );\n        break;\n      case 'strokeCircles':\n        this.currentCanvas.drawCircles(\n          args,\n          buffers,\n          this.currentCanvas.strokeCircle.bind(this.currentCanvas)\n        );\n        break;\n      case 'strokeLine':\n        this.currentCanvas.strokeLine(args, buffers);\n        break;\n      case 'strokeLines':\n        this.currentCanvas.strokeLines(args, buffers);\n        break;\n      case 'fillPolygon':\n        this.currentCanvas.fillPolygon(args, buffers);\n        break;\n      case 'strokePolygon':\n        this.currentCanvas.strokePolygon(args, buffers);\n        break;\n      case 'fillPath':\n        await this.currentCanvas.fillPath(args, buffers);\n        break;\n      case 'drawImage':\n        await this.currentCanvas.drawImage(args, buffers);\n        break;\n      case 'putImageData':\n        await this.currentCanvas.putImageData(args, buffers);\n        break;\n      case 'set':\n        await this.currentCanvas.setAttr(args[0], args[1]);\n        break;\n      case 'clear':\n        this.currentCanvas.clearCanvas();\n        break;\n      case 'fillPolygons':\n        this.currentCanvas.drawPolygonOrLineSegments(args, buffers, true, true);\n        break;\n      case 'strokePolygons':\n        this.currentCanvas.drawPolygonOrLineSegments(\n          args,\n          buffers,\n          false,\n          true\n        );\n        break;\n      case 'strokeLineSegments':\n        this.currentCanvas.drawPolygonOrLineSegments(\n          args,\n          buffers,\n          false,\n          false\n        );\n        break;\n      case 'fillStyledRects':\n        this.currentCanvas.drawStyledRects(args, buffers, true);\n        break;\n      case 'strokeStyledRects':\n        this.currentCanvas.drawStyledRects(args, buffers, false);\n        break;\n      case 'fillStyledCircles':\n        this.currentCanvas.drawStyledCircles(args, buffers, true);\n        break;\n      case 'strokeStyledCircles':\n        this.currentCanvas.drawStyledCircles(args, buffers, false);\n        break;\n      case 'fillStyledArcs':\n        this.currentCanvas.drawStyledArcs(args, buffers, true);\n        break;\n      case 'strokeStyledArcs':\n        this.currentCanvas.drawStyledArcs(args, buffers, false);\n        break;\n      case 'fillStyledPolygons':\n        this.currentCanvas.drawStyledPolygonOrLineSegments(\n          args,\n          buffers,\n          true,\n          true\n        );\n        break;\n      case 'strokeStyledPolygons':\n        this.currentCanvas.drawStyledPolygonOrLineSegments(\n          args,\n          buffers,\n          false,\n          true\n        );\n        break;\n      case 'strokeStyledLineSegments':\n        this.currentCanvas.drawStyledPolygonOrLineSegments(\n          args,\n          buffers,\n          false,\n          false\n        );\n        break;\n      default:\n        this.currentCanvas.executeCommand(name, args);\n        break;\n    }\n  }\n\n  private async switchCanvas(serializedCanvas: any) {\n    this.currentCanvas = await unpack_models(\n      serializedCanvas,\n      this.widget_manager\n    );\n  }\n\n  private currentCanvas: CanvasModel;\n  private currentProcessing: Promise<void> = Promise.resolve();\n  private canvasesToUpdate: CanvasModel[] = [];\n\n  static model_name = 'CanvasManagerModel';\n  static model_module = MODULE_NAME;\n  static model_module_version = MODULE_VERSION;\n}\n\nexport class Path2DModel extends WidgetModel {\n  defaults() {\n    return {\n      ...super.defaults(),\n      _model_name: Path2DModel.model_name,\n      _model_module: Path2DModel.model_module,\n      _model_module_version: Path2DModel.model_module_version,\n      value: ''\n    };\n  }\n\n  initialize(attributes: any, options: any) {\n    super.initialize(attributes, options);\n\n    this.value = new Path2D(this.get('value'));\n  }\n\n  value: Path2D;\n\n  static model_name = 'Path2DModel';\n  static model_module = MODULE_NAME;\n  static model_module_version = MODULE_VERSION;\n}\n\nexport class PatternModel extends WidgetModel {\n  defaults() {\n    return {\n      ...super.defaults(),\n      _model_name: PatternModel.model_name,\n      _model_module: PatternModel.model_module,\n      _model_module_version: PatternModel.model_module_version,\n      image: '',\n      repetition: 'repeat'\n    };\n  }\n\n  async initialize(attributes: any, options: any) {\n    super.initialize(attributes, options);\n\n    const image = this.get('image');\n    let patternSource: HTMLCanvasElement | HTMLImageElement | undefined =\n      undefined;\n\n    if (image instanceof CanvasModel || image instanceof MultiCanvasModel) {\n      patternSource = image.canvas;\n    }\n\n    if (image.get('_model_name') == 'ImageModel') {\n      const img = await createImageFromWidget(image);\n      patternSource = img;\n    }\n\n    if (patternSource == undefined) {\n      throw 'Could not understand the souce for the pattern';\n    }\n\n    const pattern = PatternModel.ctx.createPattern(\n      patternSource,\n      this.get('repetition')\n    );\n\n    if (pattern == null) {\n      throw 'Could not initialize pattern object';\n    }\n\n    this.value = pattern;\n  }\n\n  static serializers: ISerializers = {\n    ...WidgetModel.serializers,\n    image: { deserialize: unpack_models as any }\n  };\n\n  value: CanvasPattern;\n\n  static model_name = 'PatternModel';\n  static model_module = MODULE_NAME;\n  static model_module_version = MODULE_VERSION;\n\n  // Global context for creating the gradients\n  static ctx: CanvasRenderingContext2D = getContext(\n    document.createElement('canvas')\n  );\n}\n\nclass GradientModel extends WidgetModel {\n  defaults() {\n    return {\n      ...super.defaults(),\n      _model_module: GradientModel.model_module,\n      _model_module_version: GradientModel.model_module_version,\n      x0: 0,\n      y0: 0,\n      x1: 0,\n      y1: 0,\n      color_stops: []\n    };\n  }\n\n  initialize(attributes: any, options: any) {\n    super.initialize(attributes, options);\n\n    this.createGradient();\n\n    for (const colorStop of this.get('color_stops')) {\n      this.value.addColorStop(colorStop[0], colorStop[1]);\n    }\n  }\n\n  protected createGradient() {\n    this.value = GradientModel.ctx.createLinearGradient(\n      this.get('x0'),\n      this.get('y0'),\n      this.get('x1'),\n      this.get('y1')\n    );\n  }\n\n  value: CanvasGradient;\n\n  static model_module = MODULE_NAME;\n  static model_module_version = MODULE_VERSION;\n\n  // Global context for creating the gradients\n  static ctx: CanvasRenderingContext2D = getContext(\n    document.createElement('canvas')\n  );\n}\n\nexport class LinearGradientModel extends GradientModel {\n  defaults() {\n    return { ...super.defaults(), _model_name: LinearGradientModel.model_name };\n  }\n\n  static model_name = 'LinearGradientModel';\n}\n\nexport class RadialGradientModel extends GradientModel {\n  defaults() {\n    return {\n      ...super.defaults(),\n      _model_name: RadialGradientModel.model_name,\n      r0: 0,\n      r1: 0\n    };\n  }\n\n  protected createGradient() {\n    this.value = GradientModel.ctx.createRadialGradient(\n      this.get('x0'),\n      this.get('y0'),\n      this.get('r0'),\n      this.get('x1'),\n      this.get('y1'),\n      this.get('r1')\n    );\n  }\n\n  static model_name = 'RadialGradientModel';\n}\n\nexport class CanvasModel extends DOMWidgetModel {\n  defaults() {\n    return {\n      ...super.defaults(),\n      _model_name: CanvasModel.model_name,\n      _model_module: CanvasModel.model_module,\n      _model_module_version: CanvasModel.model_module_version,\n      _view_name: CanvasModel.view_name,\n      _view_module: CanvasModel.view_module,\n      _view_module_version: CanvasModel.view_module_version,\n      width: 700,\n      height: 500,\n      sync_image_data: false,\n      image_data: null,\n      _send_client_ready_event: true\n    };\n  }\n\n  static serializers: ISerializers = {\n    ...DOMWidgetModel.serializers,\n    _canvas_manager: { deserialize: unpack_models as any },\n    image_data: {\n      serialize: serializeImageData,\n      deserialize: deserializeImageData\n    }\n  };\n\n  static ATTRS = [\n    'fillStyle',\n    'strokeStyle',\n    'globalAlpha',\n    'font',\n    'textAlign',\n    'textBaseline',\n    'direction',\n    'globalCompositeOperation',\n    'lineWidth',\n    'lineCap',\n    'lineJoin',\n    'miterLimit',\n    'lineDashOffset',\n    'shadowOffsetX',\n    'shadowOffsetY',\n    'shadowBlur',\n    'shadowColor',\n    'filter'\n  ];\n\n  initialize(attributes: any, options: any) {\n    super.initialize(attributes, options);\n\n    this.canvas = document.createElement('canvas');\n    this.ctx = getContext(this.canvas);\n\n    this.resizeCanvas();\n    this.drawImageData();\n\n    this.on_some_change(['width', 'height'], this.resizeCanvas, this);\n    this.on('change:sync_image_data', this.syncImageData.bind(this));\n    // this.on('msg:custom', this.onCommand.bind(this));\n\n    if (this.get('_send_client_ready_event')) {\n      this.send({ event: 'client_ready' }, {});\n    }\n  }\n\n  private async drawImageData() {\n    if (this.get('image_data') !== null) {\n      const img = await fromBytes(this.get('image_data'));\n\n      this.ctx.drawImage(img, 0, 0);\n\n      this.trigger('new-frame');\n    }\n  }\n\n  async syncViews() {\n    this.forEachView((view: CanvasView) => {\n      view.updateCanvas();\n    });\n\n    this.trigger('new-frame');\n    this.syncImageData();\n  }\n\n  async sleep(time: number) {\n    this.forEachView((view: CanvasView) => {\n      view.updateCanvas();\n    });\n\n    this.trigger('new-frame');\n    this.syncImageData();\n\n    await new Promise(resolve => setTimeout(resolve, time));\n  }\n\n  fillRect(x: number, y: number, width: number, height: number) {\n    this.ctx.fillRect(x, y, width, height);\n  }\n\n  strokeRect(x: number, y: number, width: number, height: number) {\n    this.ctx.strokeRect(x, y, width, height);\n  }\n\n  drawRects(\n    args: any[],\n    buffers: any,\n    callback: (x: number, y: number, width: number, height: number) => void\n  ) {\n    const x = getArg(args[0], buffers);\n    const y = getArg(args[1], buffers);\n    const width = getArg(args[2], buffers);\n    const height = getArg(args[3], buffers);\n\n    const numberRects = Math.min(\n      x.length,\n      y.length,\n      width.length,\n      height.length\n    );\n\n    for (let idx = 0; idx < numberRects; ++idx) {\n      callback(\n        x.getItem(idx),\n        y.getItem(idx),\n        width.getItem(idx),\n        height.getItem(idx)\n      );\n    }\n  }\n\n  drawStyledRects(args: any[], buffers: any, fill: boolean) {\n    const x = getArg(args[0], buffers);\n    const y = getArg(args[1], buffers);\n    const width = getArg(args[2], buffers);\n    const height = getArg(args[3], buffers);\n    const colors = getArg(args[4], buffers);\n    const alpha = getArg(args[5], buffers);\n\n    const numberRects = Math.min(\n      x.length,\n      y.length,\n      width.length,\n      height.length\n    );\n\n    this.ctx.save();\n    for (let idx = 0; idx < numberRects; ++idx) {\n      // get color for this circle\n      const ci = 3 * idx;\n      const color = `rgba(${colors.getItem(ci)}, ${colors.getItem(\n        ci + 1\n      )}, ${colors.getItem(ci + 2)}, ${alpha.getItem(idx)})`;\n      this.setStyle(color, fill);\n      if (fill) {\n        this.fillRect(\n          x.getItem(idx),\n          y.getItem(idx),\n          width.getItem(idx),\n          height.getItem(idx)\n        );\n      } else {\n        this.strokeRect(\n          x.getItem(idx),\n          y.getItem(idx),\n          width.getItem(idx),\n          height.getItem(idx)\n        );\n      }\n    }\n    this.ctx.restore();\n  }\n\n  fillArc(\n    x: number,\n    y: number,\n    radius: number,\n    startAngle: number,\n    endAngle: number,\n    anticlockwise: boolean\n  ) {\n    this.ctx.beginPath();\n\n    this.ctx.moveTo(x, y); // Move to center\n    this.ctx.lineTo(\n      x + radius * Math.cos(startAngle),\n      y + radius * Math.sin(startAngle)\n    ); // Line to beginning of the arc\n    this.ctx.arc(x, y, radius, startAngle, endAngle, anticlockwise);\n    this.ctx.lineTo(x, y); // Line to center\n    this.ctx.fill();\n\n    this.ctx.closePath();\n  }\n\n  strokeArc(\n    x: number,\n    y: number,\n    radius: number,\n    startAngle: number,\n    endAngle: number,\n    anticlockwise: boolean\n  ) {\n    this.ctx.beginPath();\n\n    this.ctx.arc(x, y, radius, startAngle, endAngle, anticlockwise);\n    this.ctx.stroke();\n\n    this.ctx.closePath();\n  }\n\n  drawArcs(\n    args: any[],\n    buffers: any,\n    callback: (\n      x: number,\n      y: number,\n      radius: number,\n      startAngle: number,\n      endAngle: number,\n      anticlockwise: boolean\n    ) => void\n  ) {\n    const x = getArg(args[0], buffers);\n    const y = getArg(args[1], buffers);\n    const radius = getArg(args[2], buffers);\n    const startAngle = getArg(args[3], buffers);\n    const endAngle = getArg(args[4], buffers);\n    const anticlockwise = getArg(args[5], buffers);\n\n    const numberArcs = Math.min(\n      x.length,\n      y.length,\n      radius.length,\n      startAngle.length,\n      endAngle.length\n    );\n\n    for (let idx = 0; idx < numberArcs; ++idx) {\n      callback(\n        x.getItem(idx),\n        y.getItem(idx),\n        radius.getItem(idx),\n        startAngle.getItem(idx),\n        endAngle.getItem(idx),\n        anticlockwise.getItem(idx)\n      );\n    }\n  }\n\n  fillCircle(x: number, y: number, radius: number) {\n    this.ctx.beginPath();\n    this.ctx.arc(x, y, radius, 0, 2 * Math.PI);\n    this.ctx.fill();\n\n    this.ctx.closePath();\n  }\n\n  strokeCircle(x: number, y: number, radius: number) {\n    this.ctx.beginPath();\n    this.ctx.arc(x, y, radius, 0, 2 * Math.PI);\n    this.ctx.stroke();\n\n    this.ctx.closePath();\n  }\n\n  drawCircles(\n    args: any[],\n    buffers: any,\n    callback: (x: number, y: number, radius: number) => void\n  ) {\n    const x = getArg(args[0], buffers);\n    const y = getArg(args[1], buffers);\n    const radius = getArg(args[2], buffers);\n\n    const numberCircles = Math.min(x.length, y.length, radius.length);\n\n    for (let idx = 0; idx < numberCircles; ++idx) {\n      callback(x.getItem(idx), y.getItem(idx), radius.getItem(idx));\n    }\n  }\n\n  setStyle(style: any, fill: boolean) {\n    if (fill) {\n      this.ctx.fillStyle = style;\n    } else {\n      this.ctx.strokeStyle = style;\n    }\n  }\n\n  drawStyledCircles(args: any[], buffers: any, fill: boolean) {\n    const x = getArg(args[0], buffers);\n    const y = getArg(args[1], buffers);\n    const radius = getArg(args[2], buffers);\n    const colors = getArg(args[3], buffers);\n    const alpha = getArg(args[4], buffers);\n\n    const numberCircles = Math.min(x.length, y.length, radius.length);\n    this.ctx.save();\n    for (let idx = 0; idx < numberCircles; ++idx) {\n      // get color for this circle\n      const ci = 3 * idx;\n      const color = `rgba(${colors.getItem(ci)}, ${colors.getItem(\n        ci + 1\n      )}, ${colors.getItem(ci + 2)}, ${alpha.getItem(idx)})`;\n      this.setStyle(color, fill);\n      if (fill) {\n        this.fillCircle(x.getItem(idx), y.getItem(idx), radius.getItem(idx));\n      } else {\n        this.strokeCircle(x.getItem(idx), y.getItem(idx), radius.getItem(idx));\n      }\n    }\n    this.ctx.restore();\n  }\n\n  drawStyledArcs(args: any[], buffers: any, fill: boolean) {\n    const x = getArg(args[0], buffers);\n    const y = getArg(args[1], buffers);\n    const radius = getArg(args[2], buffers);\n    const startAngle = getArg(args[3], buffers);\n    const endAngle = getArg(args[4], buffers);\n    const anticlockwise = getArg(args[5], buffers);\n    const colors = getArg(args[6], buffers);\n    const alpha = getArg(args[7], buffers);\n\n    const numberArcs = Math.min(\n      x.length,\n      y.length,\n      radius.length,\n      startAngle.length,\n      endAngle.length\n    );\n\n    this.ctx.save();\n    for (let idx = 0; idx < numberArcs; ++idx) {\n      // get color for this circle\n      const ci = 3 * idx;\n      const color = `rgba(${colors.getItem(ci)}, ${colors.getItem(\n        ci + 1\n      )}, ${colors.getItem(ci + 2)}, ${alpha.getItem(idx)})`;\n      this.setStyle(color, fill);\n      if (fill) {\n        this.fillArc(\n          x.getItem(idx),\n          y.getItem(idx),\n          radius.getItem(idx),\n          startAngle.getItem(idx),\n          endAngle.getItem(idx),\n          anticlockwise.getItem(idx)\n        );\n      } else {\n        this.strokeArc(\n          x.getItem(idx),\n          y.getItem(idx),\n          radius.getItem(idx),\n          startAngle.getItem(idx),\n          endAngle.getItem(idx),\n          anticlockwise.getItem(idx)\n        );\n      }\n    }\n    this.ctx.restore();\n  }\n\n  drawStyledPolygonOrLineSegments(\n    args: any[],\n    buffers: any,\n    fill: boolean,\n    close: boolean\n  ) {\n    const numPolygons = args[0];\n    const points = getArg(args[1], buffers);\n    const sizes = getArg(args[2], buffers);\n    const colors = getArg(args[3], buffers);\n    const alpha = getArg(args[4], buffers);\n\n    this.ctx.save();\n\n    let start = 0;\n    for (let idx = 0; idx < numPolygons; ++idx) {\n      // get color for this circle\n      const ci = 3 * idx;\n      const color = `rgba(${colors.getItem(ci)}, ${colors.getItem(\n        ci + 1\n      )}, ${colors.getItem(ci + 2)}, ${alpha.getItem(idx)})`;\n      this.setStyle(color, fill);\n\n      // start / stop in the points array fr this polygon\n      const size = sizes.getItem(idx) * 2;\n      const stop = start + size;\n\n      // Move to the first point, then create lines between points\n      this.ctx.beginPath();\n      this.ctx.moveTo(points.getItem(start), points.getItem(start + 1));\n\n      // draw all points of the polygon (except start)\n      for (let idp = start + 2; idp < stop; idp += 2) {\n        this.ctx.lineTo(points.getItem(idp), points.getItem(idp + 1));\n      }\n      start = stop;\n      if (close) {\n        this.ctx.closePath();\n      }\n      fill ? this.ctx.fill() : this.ctx.stroke();\n    }\n    this.ctx.restore();\n  }\n\n  drawPolygonOrLineSegments(\n    args: any[],\n    buffers: any,\n    fill: boolean,\n    close: boolean\n  ) {\n    const numPolygons = args[0];\n    const points = getArg(args[1], buffers);\n    const sizes = getArg(args[2], buffers);\n\n    let start = 0;\n    for (let idx = 0; idx < numPolygons; ++idx) {\n      // start / stop in the points array fr this polygon\n      const size = sizes.getItem(idx) * 2;\n      const stop = start + size;\n\n      // Move to the first point, then create lines between points\n      this.ctx.beginPath();\n      this.ctx.moveTo(points.getItem(start), points.getItem(start + 1));\n\n      // draw all points of the polygon (except start)\n      for (let idp = start + 2; idp < stop; idp += 2) {\n        this.ctx.lineTo(points.getItem(idp), points.getItem(idp + 1));\n      }\n      start = stop;\n      if (close) {\n        this.ctx.closePath();\n      }\n      fill ? this.ctx.fill() : this.ctx.stroke();\n    }\n  }\n\n  strokeLine(args: any[], buffers: any) {\n    this.ctx.beginPath();\n    this.ctx.moveTo(args[0], args[1]);\n    this.ctx.lineTo(args[2], args[3]);\n    this.ctx.stroke();\n\n    this.ctx.closePath();\n  }\n\n  strokeLines(args: any[], buffers: any) {\n    this.ctx.beginPath();\n    const points = getArg(args[0], buffers);\n\n    // Move to the first point, then create lines between points\n    this.ctx.moveTo(points.getItem(0), points.getItem(1));\n    for (let idx = 2; idx < points.length; idx += 2) {\n      this.ctx.lineTo(points.getItem(idx), points.getItem(idx + 1));\n    }\n\n    this.ctx.stroke();\n    this.ctx.closePath();\n  }\n\n  fillPolygon(args: any[], buffers: any) {\n    this.ctx.beginPath();\n    const points = getArg(args[0], buffers);\n\n    // Move to the first point, then create lines between points\n    this.ctx.moveTo(points.getItem(0), points.getItem(1));\n    for (let idx = 2; idx < points.length; idx += 2) {\n      this.ctx.lineTo(points.getItem(idx), points.getItem(idx + 1));\n    }\n\n    this.ctx.closePath();\n    this.ctx.fill();\n  }\n\n  strokePolygon(args: any[], buffers: any) {\n    this.ctx.beginPath();\n    const points = getArg(args[0], buffers);\n\n    // Move to the first point, then create lines between points\n    this.ctx.moveTo(points.getItem(0), points.getItem(1));\n    for (let idx = 2; idx < points.length; idx += 2) {\n      this.ctx.lineTo(points.getItem(idx), points.getItem(idx + 1));\n    }\n\n    this.ctx.closePath();\n    this.ctx.stroke();\n  }\n\n  async fillPath(args: any[], buffers: any) {\n    const [serializedPath] = args;\n\n    const path = await unpack_models(serializedPath, this.widget_manager);\n\n    this.ctx.fill(path.value);\n  }\n\n  async drawImage(args: any[], buffers: any) {\n    const [serializedImage, x, y, width, height] = args;\n\n    const image = await unpack_models(serializedImage, this.widget_manager);\n\n    if (image instanceof CanvasModel || image instanceof MultiCanvasModel) {\n      this._drawImage(image.canvas, x, y, width, height);\n      return;\n    }\n\n    if (image.get('_model_name') == 'ImageModel') {\n      const img = await createImageFromWidget(image);\n      this._drawImage(img, x, y, width, height);\n    }\n  }\n\n  private _drawImage(\n    image: HTMLCanvasElement | HTMLImageElement,\n    x: number,\n    y: number,\n    width?: number,\n    height?: number\n  ) {\n    if (width === undefined || height === undefined) {\n      this.ctx.drawImage(image, x, y);\n    } else {\n      this.ctx.drawImage(image, x, y, width, height);\n    }\n  }\n\n  async putImageData(args: any[], buffers: any) {\n    const [x, y] = args;\n\n    const image = await bufferToImage(buffers[0]);\n\n    this._drawImage(image, x, y);\n  }\n\n  async setAttr(attr: number, value: any) {\n    if (typeof value === 'string' && value.startsWith('IPY')) {\n      const widgetModel: GradientModel = await unpack_models(\n        value,\n        this.widget_manager\n      );\n      value = widgetModel.value;\n    }\n\n    (this.ctx as any)[CanvasModel.ATTRS[attr]] = value;\n  }\n\n  clearCanvas() {\n    this.forEachView((view: CanvasView) => {\n      view.clear();\n    });\n    this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);\n  }\n\n  executeCommand(name: string, args: any[] = []) {\n    (this.ctx as any)[name](...args);\n  }\n\n  private forEachView(callback: (view: CanvasView) => void) {\n    for (const view_id in this.views) {\n      this.views[view_id].then((view: CanvasView) => {\n        callback(view);\n      });\n    }\n  }\n\n  private resizeCanvas() {\n    this.canvas.setAttribute('width', this.get('width'));\n    this.canvas.setAttribute('height', this.get('height'));\n  }\n\n  private async syncImageData() {\n    if (!this.get('sync_image_data')) {\n      return;\n    }\n\n    const bytes = await toBytes(this.canvas);\n\n    this.set('image_data', bytes);\n    this.save_changes();\n  }\n\n  static model_name = 'CanvasModel';\n  static model_module = MODULE_NAME;\n  static model_module_version = MODULE_VERSION;\n  static view_name = 'CanvasView';\n  static view_module = MODULE_NAME;\n  static view_module_version = MODULE_VERSION;\n\n  canvas: HTMLCanvasElement;\n  ctx: CanvasRenderingContext2D;\n\n  views: Dict<Promise<CanvasView>>;\n}\n\nexport class RoughCanvasModel extends CanvasModel {\n  static ROUGH_ATTRS: string[] = new Array(100).concat([\n    'roughFillStyle',\n    'roughness',\n    'bowing'\n  ]);\n\n  defaults() {\n    return { ...super.defaults(), _model_name: RoughCanvasModel.model_name };\n  }\n\n  initialize(attributes: any, options: any) {\n    super.initialize(attributes, options);\n\n    this.roughCanvas = new RoughCanvas(this.canvas);\n  }\n\n  fillRect(x: number, y: number, width: number, height: number) {\n    this.roughCanvas.rectangle(x, y, width, height, this.getRoughFillStyle());\n  }\n\n  strokeRect(x: number, y: number, width: number, height: number) {\n    this.roughCanvas.rectangle(x, y, width, height, this.getRoughStrokeStyle());\n  }\n\n  fillCircle(x: number, y: number, radius: number) {\n    this.roughCanvas.circle(x, y, 2 * radius, this.getRoughFillStyle());\n  }\n\n  strokeCircle(x: number, y: number, radius: number) {\n    this.roughCanvas.circle(x, y, 2 * radius, this.getRoughStrokeStyle());\n  }\n\n  strokeLine(args: any[], buffers: any) {\n    this.roughCanvas.line(\n      args[0],\n      args[1],\n      args[2],\n      args[3],\n      this.getRoughStrokeStyle()\n    );\n  }\n\n  strokeLines(args: any[], buffers: any) {\n    const points = getArg(args[0], buffers);\n\n    const polygon: [number, number][] = [];\n    for (let idx = 0; idx < points.length; idx += 2) {\n      polygon.push([points.getItem(idx), points.getItem(idx + 1)]);\n    }\n\n    this.roughCanvas.linearPath(polygon, this.getRoughStrokeStyle());\n  }\n\n  async fillPath(args: any[], buffers: any) {\n    const [serializedPath] = args;\n\n    const path = await unpack_models(serializedPath, this.widget_manager);\n\n    this.roughCanvas.path(path.get('value'), this.getRoughFillStyle());\n  }\n\n  fillArc(\n    x: number,\n    y: number,\n    radius: number,\n    startAngle: number,\n    endAngle: number,\n    anticlockwise: boolean\n  ) {\n    const ellipseSize = 2 * radius;\n\n    // The following is needed because roughjs does not allow a clockwise draw\n    const start = anticlockwise ? endAngle : startAngle;\n    const end = anticlockwise ? startAngle + 2 * Math.PI : endAngle;\n\n    this.roughCanvas.arc(\n      x,\n      y,\n      ellipseSize,\n      ellipseSize,\n      start,\n      end,\n      true,\n      this.getRoughFillStyle()\n    );\n  }\n\n  strokeArc(\n    x: number,\n    y: number,\n    radius: number,\n    startAngle: number,\n    endAngle: number,\n    anticlockwise: boolean\n  ) {\n    const ellipseSize = 2 * radius;\n\n    // The following is needed because roughjs does not allow a clockwise draw\n    const start = anticlockwise ? endAngle : startAngle;\n    const end = anticlockwise ? startAngle + 2 * Math.PI : endAngle;\n\n    this.roughCanvas.arc(\n      x,\n      y,\n      ellipseSize,\n      ellipseSize,\n      start,\n      end,\n      false,\n      this.getRoughStrokeStyle()\n    );\n  }\n\n  fillPolygon(args: any[], buffers: any) {\n    const points = getArg(args[0], buffers);\n\n    const polygon: [number, number][] = [];\n    for (let idx = 0; idx < points.length; idx += 2) {\n      polygon.push([points.getItem(idx), points.getItem(idx + 1)]);\n    }\n\n    this.roughCanvas.polygon(polygon, this.getRoughFillStyle());\n  }\n\n  strokePolygon(args: any[], buffers: any) {\n    const points = getArg(args[0], buffers);\n\n    const polygon: [number, number][] = [];\n    for (let idx = 0; idx < points.length; idx += 2) {\n      polygon.push([points.getItem(idx), points.getItem(idx + 1)]);\n    }\n\n    this.roughCanvas.polygon(polygon, this.getRoughStrokeStyle());\n  }\n\n  async setAttr(attr: number, value: any) {\n    if (RoughCanvasModel.ROUGH_ATTRS[attr]) {\n      (this as any)[RoughCanvasModel.ROUGH_ATTRS[attr]] = value;\n\n      return;\n    }\n\n    await super.setAttr(attr, value);\n  }\n\n  private getRoughFillStyle() {\n    const fill = this.ctx.fillStyle as string;\n    const lineWidth = this.ctx.lineWidth;\n\n    return {\n      fill,\n      fillStyle: this.roughFillStyle,\n      fillWeight: lineWidth / 2,\n      hachureGap: lineWidth * 4,\n      curveStepCount: 18,\n      strokeWidth: 0.001, // This is to ensure there is no stroke,\n      roughness: this.roughness,\n      bowing: this.bowing\n    };\n  }\n\n  private getRoughStrokeStyle() {\n    const stroke = this.ctx.strokeStyle as string;\n    const lineWidth = this.ctx.lineWidth;\n\n    return {\n      stroke,\n      strokeWidth: lineWidth,\n      roughness: this.roughness,\n      bowing: this.bowing,\n      curveStepCount: 18\n    };\n  }\n\n  static model_name = 'RoughCanvasModel';\n\n  roughCanvas: RoughCanvas;\n\n  roughFillStyle: string = 'hachure';\n  roughness: number = 1;\n  bowing: number = 1;\n}\n\nexport class CanvasView extends DOMWidgetView {\n  render() {\n    this.ctx = getContext(this.el);\n\n    this.resizeCanvas();\n    this.model.on_some_change(['width', 'height'], this.resizeCanvas, this);\n\n    this.el.addEventListener('mousemove', {\n      handleEvent: this.onMouseMove.bind(this)\n    });\n    this.el.addEventListener('mousedown', {\n      handleEvent: this.onMouseDown.bind(this)\n    });\n    this.el.addEventListener('mouseup', {\n      handleEvent: this.onMouseUp.bind(this)\n    });\n    this.el.addEventListener('mouseout', {\n      handleEvent: this.onMouseOut.bind(this)\n    });\n    this.el.addEventListener('touchstart', {\n      handleEvent: this.onTouchStart.bind(this)\n    });\n    this.el.addEventListener('touchend', {\n      handleEvent: this.onTouchEnd.bind(this)\n    });\n    this.el.addEventListener('touchmove', {\n      handleEvent: this.onTouchMove.bind(this)\n    });\n    this.el.addEventListener('touchcancel', {\n      handleEvent: this.onTouchCancel.bind(this)\n    });\n    this.el.addEventListener('keydown', {\n      handleEvent: this.onKeyDown.bind(this)\n    });\n\n    this.el.setAttribute('tabindex', '0');\n\n    this.updateCanvas();\n  }\n\n  clear() {\n    this.ctx.clearRect(0, 0, this.el.width, this.el.height);\n  }\n\n  updateCanvas() {\n    this.clear();\n    this.ctx.drawImage(this.model.canvas, 0, 0);\n  }\n\n  protected resizeCanvas() {\n    this.el.setAttribute('width', this.model.get('width'));\n    this.el.setAttribute('height', this.model.get('height'));\n  }\n\n  private onMouseMove(event: MouseEvent) {\n    this.model.send({ event: 'mouse_move', ...this.getCoordinates(event) }, {});\n  }\n\n  private onMouseDown(event: MouseEvent) {\n    // Bring focus to the canvas element, so keyboard events can be triggered\n    this.el.focus();\n\n    this.model.send({ event: 'mouse_down', ...this.getCoordinates(event) }, {});\n  }\n\n  private onMouseUp(event: MouseEvent) {\n    this.model.send({ event: 'mouse_up', ...this.getCoordinates(event) }, {});\n  }\n\n  private onMouseOut(event: MouseEvent) {\n    this.model.send({ event: 'mouse_out', ...this.getCoordinates(event) }, {});\n  }\n\n  private onTouchStart(event: TouchEvent) {\n    const touches: Touch[] = Array.from(event.touches);\n    this.model.send(\n      {\n        event: 'touch_start',\n        touches: touches.map(this.getCoordinates.bind(this))\n      },\n      {}\n    );\n  }\n\n  private onTouchEnd(event: TouchEvent) {\n    const touches: Touch[] = Array.from(event.touches);\n    this.model.send(\n      {\n        event: 'touch_end',\n        touches: touches.map(this.getCoordinates.bind(this))\n      },\n      {}\n    );\n  }\n\n  private onTouchMove(event: TouchEvent) {\n    const touches: Touch[] = Array.from(event.touches);\n    this.model.send(\n      {\n        event: 'touch_move',\n        touches: touches.map(this.getCoordinates.bind(this))\n      },\n      {}\n    );\n  }\n\n  private onTouchCancel(event: TouchEvent) {\n    const touches: Touch[] = Array.from(event.touches);\n    this.model.send(\n      {\n        event: 'touch_cancel',\n        touches: touches.map(this.getCoordinates.bind(this))\n      },\n      {}\n    );\n  }\n\n  private onKeyDown(event: KeyboardEvent) {\n    event.preventDefault();\n    event.stopPropagation();\n\n    this.model.send(\n      {\n        event: 'key_down',\n        key: event.key,\n        shift_key: event.shiftKey,\n        ctrl_key: event.ctrlKey,\n        meta_key: event.metaKey\n      },\n      {}\n    );\n  }\n\n  protected getCoordinates(event: MouseEvent | Touch) {\n    const rect = this.el.getBoundingClientRect();\n\n    const x = (this.el.width * (event.clientX - rect.left)) / rect.width;\n    const y = (this.el.height * (event.clientY - rect.top)) / rect.height;\n\n    return { x, y };\n  }\n\n  get tagName(): string {\n    return 'canvas';\n  }\n\n  el: HTMLCanvasElement;\n  ctx: CanvasRenderingContext2D;\n\n  model: CanvasModel | MultiCanvasModel;\n}\n\nexport class MultiCanvasModel extends DOMWidgetModel {\n  defaults() {\n    return {\n      ...super.defaults(),\n      _model_name: MultiCanvasModel.model_name,\n      _model_module: MultiCanvasModel.model_module,\n      _model_module_version: MultiCanvasModel.model_module_version,\n      _view_name: MultiCanvasModel.view_name,\n      _view_module: MultiCanvasModel.view_module,\n      _view_module_version: MultiCanvasModel.view_module_version,\n      _canvases: [],\n      sync_image_data: false,\n      image_data: null,\n      width: 700,\n      height: 500\n    };\n  }\n\n  static serializers: ISerializers = {\n    ...DOMWidgetModel.serializers,\n    _canvases: { deserialize: unpack_models as any },\n    image_data: {\n      serialize: (bytes: Uint8ClampedArray) => {\n        return new DataView(bytes.buffer.slice(0));\n      }\n    }\n  };\n\n  initialize(attributes: any, options: any) {\n    super.initialize(attributes, options);\n\n    this.canvas = document.createElement('canvas');\n    this.ctx = getContext(this.canvas);\n\n    this.resizeCanvas();\n\n    this.on_some_change(['width', 'height'], this.resizeCanvas, this);\n    this.on('change:_canvases', this.updateCanvasModels.bind(this));\n    this.on('change:sync_image_data', this.syncImageData.bind(this));\n\n    this.updateCanvasModels();\n  }\n\n  get canvasModels(): CanvasModel[] {\n    return this.get('_canvases');\n  }\n\n  private updateCanvasModels() {\n    // TODO: Remove old listeners\n    for (const canvasModel of this.canvasModels) {\n      canvasModel.on('new-frame', this.updateCanvas, this);\n    }\n\n    this.updateCanvas();\n  }\n\n  private updateCanvas() {\n    this.ctx.clearRect(0, 0, this.get('width'), this.get('height'));\n\n    for (const canvasModel of this.canvasModels) {\n      this.ctx.drawImage(canvasModel.canvas, 0, 0);\n    }\n\n    this.forEachView((view: MultiCanvasView) => {\n      view.updateCanvas();\n    });\n\n    this.syncImageData();\n  }\n\n  private resizeCanvas() {\n    this.canvas.setAttribute('width', this.get('width'));\n    this.canvas.setAttribute('height', this.get('height'));\n  }\n\n  private async syncImageData() {\n    if (!this.get('sync_image_data')) {\n      return;\n    }\n\n    const bytes = await toBytes(this.canvas);\n\n    this.set('image_data', bytes);\n    this.save_changes();\n  }\n\n  private forEachView(callback: (view: MultiCanvasView) => void) {\n    for (const view_id in this.views) {\n      this.views[view_id].then((view: MultiCanvasView) => {\n        callback(view);\n      });\n    }\n  }\n\n  canvas: HTMLCanvasElement;\n  ctx: CanvasRenderingContext2D;\n\n  views: Dict<Promise<MultiCanvasView>>;\n\n  static model_name = 'MultiCanvasModel';\n  static model_module = MODULE_NAME;\n  static model_module_version = MODULE_VERSION;\n  static view_name = 'MultiCanvasView';\n  static view_module = MODULE_NAME;\n  static view_module_version = MODULE_VERSION;\n}\n\nexport class MultiCanvasView extends CanvasView {\n  model: MultiCanvasModel;\n}\n","// Copyright (c) Jupyter Development Team.\n// Distributed under the terms of the Modified BSD License.\n\n// Entry point for the notebook bundle containing custom model definitions.\n//\n// Setup notebook base URL\n//\n// Some static assets may be required by the custom widget javascript. The base\n// url for the notebook is not known at build time and is therefore computed\n// dynamically.\n(window as any).__webpack_public_path__ =\n  document.querySelector('body')!.getAttribute('data-base-url') +\n  'nbextensions/ipycanvas';\n\nexport * from './index';\n"],"names":["exports","byteLength","b64","lens","getLens","validLen","placeHoldersLen","toByteArray","tmp","i","arr","Arr","_byteLength","curByte","len","revLookup","charCodeAt","fromByteArray","uint8","length","extraBytes","parts","maxChunkLength","len2","push","encodeChunk","lookup","join","Uint8Array","Array","code","Error","indexOf","start","end","num","output","base64","ieee754","isArray","kMaxLength","Buffer","TYPED_ARRAY_SUPPORT","createBuffer","that","RangeError","__proto__","prototype","arg","encodingOrOffset","this","allocUnsafe","from","value","TypeError","ArrayBuffer","array","byteOffset","undefined","fromArrayLike","fromArrayBuffer","string","encoding","isEncoding","actual","write","slice","fromString","obj","isBuffer","checked","copy","buffer","val","type","data","fromObject","assertSize","size","toString","isView","loweredCase","utf8ToBytes","base64ToBytes","toLowerCase","slowToString","hexSlice","utf8Slice","asciiSlice","latin1Slice","base64Slice","utf16leSlice","swap","b","n","m","bidirectionalIndexOf","dir","isNaN","arrayIndexOf","call","lastIndexOf","indexSize","arrLength","valLength","String","read","buf","readUInt16BE","foundIndex","found","j","hexWrite","offset","Number","remaining","strLen","parsed","parseInt","substr","utf8Write","blitBuffer","asciiWrite","str","byteArray","asciiToBytes","latin1Write","base64Write","ucs2Write","units","c","hi","lo","utf16leToBytes","Math","min","res","secondByte","thirdByte","fourthByte","tempCodePoint","firstByte","codePoint","bytesPerSequence","codePoints","MAX_ARGUMENTS_LENGTH","fromCharCode","apply","decodeCodePointsArray","g","foo","subarray","e","typedArraySupport","poolSize","_augment","Symbol","species","Object","defineProperty","configurable","alloc","fill","allocUnsafeSlow","_isBuffer","compare","a","x","y","concat","list","pos","swap16","swap32","swap64","arguments","equals","inspect","max","match","target","thisStart","thisEnd","thisCopy","targetCopy","includes","isFinite","toJSON","_arr","ret","out","bytes","checkOffset","ext","checkInt","objectWriteUInt16","littleEndian","objectWriteUInt32","checkIEEE754","writeFloat","noAssert","writeDouble","newBuf","sliceLen","readUIntLE","mul","readUIntBE","readUInt8","readUInt16LE","readUInt32LE","readUInt32BE","readIntLE","pow","readIntBE","readInt8","readInt16LE","readInt16BE","readInt32LE","readInt32BE","readFloatLE","readFloatBE","readDoubleLE","readDoubleBE","writeUIntLE","writeUIntBE","writeUInt8","floor","writeUInt16LE","writeUInt16BE","writeUInt32LE","writeUInt32BE","writeIntLE","limit","sub","writeIntBE","writeInt8","writeInt16LE","writeInt16BE","writeInt32LE","writeInt32BE","writeFloatLE","writeFloatBE","writeDoubleLE","writeDoubleBE","targetStart","set","INVALID_BASE64_RE","Infinity","leadSurrogate","trim","replace","stringtrim","base64clean","src","dst","isLE","mLen","nBytes","eLen","eMax","eBias","nBits","d","s","NaN","rt","abs","log","LN2","module","__WEBPACK_EXTERNAL_MODULE__146__","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","definition","key","o","enumerable","get","globalThis","Function","window","prop","hasOwnProperty","r","toStringTag","MODULE_VERSION","version","MODULE_NAME","name","rotatePoints","points","center","degrees","cx","cy","angle","PI","cos","sin","forEach","p","lineLength","line","p1","p2","sqrt","polygonHachureLines","polygonList","hachureAngle","gap","hachureGap","strokeWidth","rotationCenter","polygon","lines","vertexArray","vertices","edges","ymin","ymax","islope","sort","e1","e2","activeEdges","ix","splice","edge","filter","ae","ae1","ae2","nexti","ce","ne","round","straightHachureLines","rotateLines","HachureFiller","constructor","helper","fillPolygons","_fillPolygons","ops","renderLines","doubleLineOps","ZigZagFiller","assign","zigZagAngle","zigzagLines","dgx","dgy","HatchFiller","o2","set2","DotFiller","dotsOnLines","fweight","fillWeight","ro","dl","count","ceil","minY","random","el","ellipse","DashedFiller","dashedLine","dashOffset","dashGap","startOffset","alpha","atan","lstart","lend","ZigZagLineFiller","zo","zigzagOffset","dz","middle","fillers","Random","seed","next","imul","PARAMS","A","C","H","h","L","l","M","Q","q","S","T","t","V","v","Z","z","isType","token","parsePath","segments","tokens","RegExp","$1","text","parseFloat","tokenize","mode","index","paramsCount","params","numbeToken","segment","absolutize","subx","suby","newdata","map","normalize","lastType","lcx","lcy","cx1","cy1","x1","y1","cx2","cy2","r1","r2","largeArcFlag","sweepFlag","arcToCubicCurves","curve","rotate","angleRad","x2","y2","recursive","f1","f2","r1Pow","r2Pow","left","right","k","asin","toFixed","df","f2old","x2old","y2old","c1","s1","c2","s2","tan","hx","hy","m1","m2","m3","m4","curves","r3","randOffset","_offsetOpt","randOffsetWithRange","_offset","width","height","ellipseWithParams","generateEllipseParams","opset","_doubleLine","linearPath","close","psq","stepCount","curveStepCount","increment","rx","ry","curveFitRandomness","curveFitting","ellipseParams","ap1","cp1","_computeEllipsePoints","o1","_curve","disableMultiStroke","roughness","ap2","estimatedPoints","arc","stop","closed","roughClosure","strt","stp","ellipseInc","arcInc","_arc","op","solidFillPolygon","maxRandomnessOffset","patternFillPolygons","fillerName","fillStyle","getFiller","randomizer","roughnessGain","filling","singleStroke","disableMultiStrokeFill","_line","move","overlay","lengthSq","halfOffset","divergePoint","midDispX","bowing","midDispY","randomHalf","randomFull","preserveVertices","_curveWithOffset","ps","closePoint","curveTightness","cachedVertArray","overlap","corePoints","allPoints","radOffset","endAngle","_bezierTo","current","ros","f","iterations","clone","distanceSq","distanceToSegmentSq","w","l2","lerp","getPointsOnBezierCurveWithSplitting","tolerance","newPoints","outPoints","p3","p4","ux","uy","vx","vy","flatness","p0","q1","q2","q3","red","simplify","distance","simplifyPoints","epsilon","maxDistSq","maxNdx","distSq","pointsOnBezierCurves","numSegments","NOS","RoughGenerator","config","defaultOptions","stroke","options","_o","static","_d","shape","sets","rectangle","paths","outline","ellipseResponse","circle","diameter","fillOptions","patternFillArc","result","cloneOptionsAlterSeed","bcurve","pointsIn","curveToBezier","polyPoints","path","hasFill","hasStroke","simplified","simplification","normalized","currentPoints","pendingCurve","appendPendingCurve","appendPendingPoints","lastPoint","simplifiedSet","pointsOnPath","first","pv","svgPath","opsToPath","drawing","fixedDecimals","item","toPaths","drawable","fillSketch","RoughCanvas","canvas","ctx","getContext","gen","draw","getDefaultOptions","precision","fixedDecimalPlaceDigits","save","strokeStyle","lineWidth","strokeLineDash","setLineDash","strokeLineDashOffset","lineDashOffset","_drawToContext","restore","fillRule","fillLineDash","fillLineDashOffset","rule","beginPath","moveTo","bezierCurveTo","lineTo","generator","getTypedArray","dataview","metadata","dtype","Int8Array","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","Scalar","isScalar","Arg","ScalarArg","super","getItem","idx","BufferArg","bufferMetadata","getArg","buffers","async","toBytes","blob","Promise","resolve","reject","toBlob","reader","FileReader","onloadend","Uint8ClampedArray","readAsArrayBuffer","context","createImageFromWidget","image","url","format","Blob","URL","createObjectURL","TextDecoder","decode","img","Image","onload","COMMANDS","CanvasManagerModel","WidgetModel","currentProcessing","canvasesToUpdate","defaults","_model_name","model_name","_model_module","model_module","_model_module_version","model_module_version","initialize","attributes","on","command","then","onCommand","commands","JSON","parse","currentCanvas","processCommand","syncViews","remainingBuffers","subcommand","subbuffers","nBuffers","args","switchCanvas","sleep","fillRect","strokeRect","drawRects","bind","fillArc","strokeArc","drawArcs","fillCircle","strokeCircle","drawCircles","strokeLine","strokeLines","fillPolygon","strokePolygon","fillPath","drawImage","putImageData","setAttr","clearCanvas","drawPolygonOrLineSegments","drawStyledRects","drawStyledCircles","drawStyledArcs","drawStyledPolygonOrLineSegments","executeCommand","serializedCanvas","unpack_models","widget_manager","Path2DModel","Path2D","PatternModel","repetition","patternSource","CanvasModel","MultiCanvasModel","pattern","createPattern","serializers","deserialize","document","createElement","GradientModel","x0","y0","color_stops","createGradient","colorStop","addColorStop","createLinearGradient","LinearGradientModel","RadialGradientModel","r0","createRadialGradient","DOMWidgetModel","_view_name","view_name","_view_module","view_module","_view_module_version","view_module_version","sync_image_data","image_data","_send_client_ready_event","resizeCanvas","drawImageData","on_some_change","syncImageData","send","event","fromBytes","trigger","forEachView","view","updateCanvas","time","setTimeout","callback","numberRects","colors","ci","color","setStyle","radius","startAngle","anticlockwise","closePath","numberArcs","numberCircles","style","numPolygons","sizes","idp","serializedPath","serializedImage","_drawImage","bufferToImage","attr","startsWith","ATTRS","clear","clearRect","view_id","views","setAttribute","save_changes","_canvas_manager","serialize","DataView","RoughCanvasModel","roughFillStyle","roughCanvas","getRoughFillStyle","getRoughStrokeStyle","ellipseSize","ROUGH_ATTRS","CanvasView","DOMWidgetView","render","model","addEventListener","handleEvent","onMouseMove","onMouseDown","onMouseUp","onMouseOut","onTouchStart","onTouchEnd","onTouchMove","onTouchCancel","onKeyDown","getCoordinates","focus","touches","preventDefault","stopPropagation","shift_key","shiftKey","ctrl_key","ctrlKey","meta_key","metaKey","rect","getBoundingClientRect","clientX","clientY","top","tagName","_canvases","updateCanvasModels","canvasModels","canvasModel","MultiCanvasView","__webpack_public_path__","querySelector","getAttribute"],"sourceRoot":""}